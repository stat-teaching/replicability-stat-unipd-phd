<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.52">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Filippo Gambarota">
<meta name="dcterms.date" content="2024-02-08">

<title>Meta-Analysis and Multi-Lab Replication studies â€“ Replicability crisis in science?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Replicability crisis in science?</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../materials.html"> 
<span class="menu-text">Materials</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/stat-teaching/replicability-stat-unipd-phd"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a>
  <ul class="collapse">
  <li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages">Packages</a></li>
  </ul></li>
  <li><a href="#meta-analysis" id="toc-meta-analysis" class="nav-link" data-scroll-target="#meta-analysis">Meta-analysis</a>
  <ul class="collapse">
  <li><a href="#meta-analysis-1" id="toc-meta-analysis-1" class="nav-link" data-scroll-target="#meta-analysis-1">Meta-analysis</a></li>
  <li><a href="#effect-size" id="toc-effect-size" class="nav-link" data-scroll-target="#effect-size">Effect size</a></li>
  <li><a href="#effect-size-1" id="toc-effect-size-1" class="nav-link" data-scroll-target="#effect-size-1">Effect size</a></li>
  <li><a href="#sec-effsize-se" id="toc-sec-effsize-se" class="nav-link" data-scroll-target="#sec-effsize-se">Effect size sampling variability</a></li>
  <li><a href="#notation" id="toc-notation" class="nav-link" data-scroll-target="#notation">Notation</a></li>
  <li><a href="#extra---simulating-meta-analysis" id="toc-extra---simulating-meta-analysis" class="nav-link" data-scroll-target="#extra---simulating-meta-analysis">Extra - Simulating Meta-Analysis</a></li>
  <li><a href="#meta-analysis-as-a-weighted-average" id="toc-meta-analysis-as-a-weighted-average" class="nav-link" data-scroll-target="#meta-analysis-as-a-weighted-average">Meta-analysis as a (weighted) average</a></li>
  <li><a href="#meta-analysis-as-a-weighted-average-1" id="toc-meta-analysis-as-a-weighted-average-1" class="nav-link" data-scroll-target="#meta-analysis-as-a-weighted-average-1">Meta-analysis as a (weighted) average</a></li>
  <li><a href="#meta-analysis-as-a-weighted-average-2" id="toc-meta-analysis-as-a-weighted-average-2" class="nav-link" data-scroll-target="#meta-analysis-as-a-weighted-average-2">Meta-analysis as a (weighted) average</a></li>
  <li><a href="#meta-analysis-as-a-weighted-average-3" id="toc-meta-analysis-as-a-weighted-average-3" class="nav-link" data-scroll-target="#meta-analysis-as-a-weighted-average-3">Meta-analysis as a (weighted) average</a></li>
  <li><a href="#sec-ee" id="toc-sec-ee" class="nav-link" data-scroll-target="#sec-ee">Equal-effects model (EE)</a></li>
  <li><a href="#sec-ee-high-low" id="toc-sec-ee-high-low" class="nav-link" data-scroll-target="#sec-ee-high-low">Equal-effects model (EE)</a></li>
  <li><a href="#equal-effects-model-ee" id="toc-equal-effects-model-ee" class="nav-link" data-scroll-target="#equal-effects-model-ee">Equal-effects model (EE)</a></li>
  </ul></li>
  <li><a href="#are-the-ee-assumptions-realistic" id="toc-are-the-ee-assumptions-realistic" class="nav-link" data-scroll-target="#are-the-ee-assumptions-realistic">Are the EE assumptions realistic?</a>
  <ul class="collapse">
  <li><a href="#are-the-ee-assumptions-realistic-1" id="toc-are-the-ee-assumptions-realistic-1" class="nav-link" data-scroll-target="#are-the-ee-assumptions-realistic-1">Are the EE assumptions realistic?</a></li>
  <li><a href="#are-the-ee-assumptions-realistic-2" id="toc-are-the-ee-assumptions-realistic-2" class="nav-link" data-scroll-target="#are-the-ee-assumptions-realistic-2">Are the EE assumptions realistic?</a></li>
  <li><a href="#random-effects-model-re" id="toc-random-effects-model-re" class="nav-link" data-scroll-target="#random-effects-model-re">Random-effects model (RE)</a></li>
  <li><a href="#random-effects-model" id="toc-random-effects-model" class="nav-link" data-scroll-target="#random-effects-model">Random-effects model</a></li>
  <li><a href="#random-effects-model-1" id="toc-random-effects-model-1" class="nav-link" data-scroll-target="#random-effects-model-1">Random-effects model</a></li>
  <li><a href="#extra---simulating-meta-analysis-1" id="toc-extra---simulating-meta-analysis-1" class="nav-link" data-scroll-target="#extra---simulating-meta-analysis-1">Extra - Simulating Meta-Analysis</a></li>
  <li><a href="#heterogeneity" id="toc-heterogeneity" class="nav-link" data-scroll-target="#heterogeneity">Heterogeneity</a></li>
  <li><a href="#the-q-statistics" id="toc-the-q-statistics" class="nav-link" data-scroll-target="#the-q-statistics">The Q Statistics</a></li>
  <li><a href="#the-q-statistics-1" id="toc-the-q-statistics-1" class="nav-link" data-scroll-target="#the-q-statistics-1">The Q Statistics</a></li>
  <li><a href="#the-q-statistics-2" id="toc-the-q-statistics-2" class="nav-link" data-scroll-target="#the-q-statistics-2">The Q Statistics</a></li>
  <li><a href="#the-q-statistics-3" id="toc-the-q-statistics-3" class="nav-link" data-scroll-target="#the-q-statistics-3">The Q Statistics</a></li>
  <li><a href="#estimating-tau2" id="toc-estimating-tau2" class="nav-link" data-scroll-target="#estimating-tau2">Estimating <span class="math inline">\(\tau^2\)</span></a></li>
  <li><a href="#tau2-as-heterogeneity-measure" id="toc-tau2-as-heterogeneity-measure" class="nav-link" data-scroll-target="#tau2-as-heterogeneity-measure"><span class="math inline">\(\tau^2\)</span> as heterogeneity measure</a></li>
  <li><a href="#tau2-as-heterogeneity-measure-1" id="toc-tau2-as-heterogeneity-measure-1" class="nav-link" data-scroll-target="#tau2-as-heterogeneity-measure-1"><span class="math inline">\(\tau^2\)</span> as heterogeneity measure</a></li>
  <li><a href="#i2-higgins2002-fh" id="toc-i2-higgins2002-fh" class="nav-link" data-scroll-target="#i2-higgins2002-fh"><span class="math inline">\(I^2\)</span> <span class="citation" data-cites="Higgins2002-fh">(Higgins and Thompson 2002)</span></a></li>
  <li><a href="#i2-higgins2002-fh-1" id="toc-i2-higgins2002-fh-1" class="nav-link" data-scroll-target="#i2-higgins2002-fh-1"><span class="math inline">\(I^2\)</span> <span class="citation" data-cites="Higgins2002-fh">(Higgins and Thompson 2002)</span></a></li>
  <li><a href="#i2-higgins2002-fh-2" id="toc-i2-higgins2002-fh-2" class="nav-link" data-scroll-target="#i2-higgins2002-fh-2"><span class="math inline">\(I^2\)</span> <span class="citation" data-cites="Higgins2002-fh">(Higgins and Thompson 2002)</span></a></li>
  </ul></li>
  <li><a href="#meta-analysis-in-r" id="toc-meta-analysis-in-r" class="nav-link" data-scroll-target="#meta-analysis-in-r">Meta-analysis in R</a>
  <ul class="collapse">
  <li><a href="#meta-analysis-in-r-1" id="toc-meta-analysis-in-r-1" class="nav-link" data-scroll-target="#meta-analysis-in-r-1">Meta-analysis in R</a></li>
  <li><a href="#equal-effects-model-in-r" id="toc-equal-effects-model-in-r" class="nav-link" data-scroll-target="#equal-effects-model-in-r">Equal-effects model in R</a></li>
  <li><a href="#equal-effects-model-in-r-1" id="toc-equal-effects-model-in-r-1" class="nav-link" data-scroll-target="#equal-effects-model-in-r-1">Equal-effects model in R</a></li>
  <li><a href="#equal-effects-model-in-r-2" id="toc-equal-effects-model-in-r-2" class="nav-link" data-scroll-target="#equal-effects-model-in-r-2">Equal-effects model in R</a></li>
  <li><a href="#equal-effects-model-in-r-3" id="toc-equal-effects-model-in-r-3" class="nav-link" data-scroll-target="#equal-effects-model-in-r-3">Equal-effects model in R</a></li>
  <li><a href="#equal-effects-model-in-r-4" id="toc-equal-effects-model-in-r-4" class="nav-link" data-scroll-target="#equal-effects-model-in-r-4">Equal-effects model in R</a></li>
  <li><a href="#random-effects-model-in-r" id="toc-random-effects-model-in-r" class="nav-link" data-scroll-target="#random-effects-model-in-r">Random-effects model in R</a></li>
  <li><a href="#random-effects-model-in-r-1" id="toc-random-effects-model-in-r-1" class="nav-link" data-scroll-target="#random-effects-model-in-r-1">Random-effects model in R</a></li>
  <li><a href="#random-effects-model-in-r-2" id="toc-random-effects-model-in-r-2" class="nav-link" data-scroll-target="#random-effects-model-in-r-2">Random-effects model in R</a></li>
  <li><a href="#forest-plot" id="toc-forest-plot" class="nav-link" data-scroll-target="#forest-plot">Forest Plot</a></li>
  <li><a href="#forest-plot-1" id="toc-forest-plot-1" class="nav-link" data-scroll-target="#forest-plot-1">Forest Plot</a></li>
  <li><a href="#forest-plot-2" id="toc-forest-plot-2" class="nav-link" data-scroll-target="#forest-plot-2">Forest Plot</a></li>
  </ul></li>
  <li><a href="#multilab-studies" id="toc-multilab-studies" class="nav-link" data-scroll-target="#multilab-studies">Multilab Studies</a>
  <ul class="collapse">
  <li><a href="#multilab-studies-1" id="toc-multilab-studies-1" class="nav-link" data-scroll-target="#multilab-studies-1">Multilab Studies</a></li>
  <li><a href="#multilab-studies-2" id="toc-multilab-studies-2" class="nav-link" data-scroll-target="#multilab-studies-2">Multilab Studies</a></li>
  <li><a href="#multilab-studies-and-meta-analysis" id="toc-multilab-studies-and-meta-analysis" class="nav-link" data-scroll-target="#multilab-studies-and-meta-analysis">Multilab Studies and meta-analysis</a></li>
  <li><a href="#extra---planning-a-multilab-study" id="toc-extra---planning-a-multilab-study" class="nav-link" data-scroll-target="#extra---planning-a-multilab-study">Extra - Planning a Multilab Study</a></li>
  <li><a href="#extra---planning-a-multilab-study-1" id="toc-extra---planning-a-multilab-study-1" class="nav-link" data-scroll-target="#extra---planning-a-multilab-study-1">Extra - Planning a Multilab Study</a></li>
  <li><a href="#extra---planning-a-multilab-study-2" id="toc-extra---planning-a-multilab-study-2" class="nav-link" data-scroll-target="#extra---planning-a-multilab-study-2">Extra - Planning a Multilab Study</a></li>
  <li><a href="#extra---planning-a-multilab-study-3" id="toc-extra---planning-a-multilab-study-3" class="nav-link" data-scroll-target="#extra---planning-a-multilab-study-3">Extra - Planning a Multilab Study</a></li>
  <li><a href="#extra---planning-a-multilab-study-4" id="toc-extra---planning-a-multilab-study-4" class="nav-link" data-scroll-target="#extra---planning-a-multilab-study-4">Extra - Planning a Multilab Study</a></li>
  </ul></li>
  <li><a href="#publication-bias-pb" id="toc-publication-bias-pb" class="nav-link" data-scroll-target="#publication-bias-pb">Publication Bias (PB)</a></li>
  <li><a href="#what-do-you-think-about-pb-what-do-you-know-causes-remedies" id="toc-what-do-you-think-about-pb-what-do-you-know-causes-remedies" class="nav-link" data-scroll-target="#what-do-you-think-about-pb-what-do-you-know-causes-remedies">What do you think about PB? What do you know? Causes? Remedies?</a>
  <ul class="collapse">
  <li><a href="#publication-bias-pb-1" id="toc-publication-bias-pb-1" class="nav-link" data-scroll-target="#publication-bias-pb-1">Publication Bias (PB)</a></li>
  <li><a href="#publication-bias-disclaimer" id="toc-publication-bias-disclaimer" class="nav-link" data-scroll-target="#publication-bias-disclaimer">Publication Bias Disclaimer!</a></li>
  <li><a href="#publication-bias-pb---the-big-picture" id="toc-publication-bias-pb---the-big-picture" class="nav-link" data-scroll-target="#publication-bias-pb---the-big-picture">Publication Bias (PB) - The Big Picture</a></li>
  <li><a href="#publication-bias-pb---funnel-plot" id="toc-publication-bias-pb---funnel-plot" class="nav-link" data-scroll-target="#publication-bias-pb---funnel-plot">Publication Bias (PB) - Funnel Plot</a></li>
  <li><a href="#publication-bias-pb---funnel-plot-1" id="toc-publication-bias-pb---funnel-plot-1" class="nav-link" data-scroll-target="#publication-bias-pb---funnel-plot-1">Publication Bias (PB) - Funnel Plot</a></li>
  <li><a href="#publication-bias-pb---funnel-plot-2" id="toc-publication-bias-pb---funnel-plot-2" class="nav-link" data-scroll-target="#publication-bias-pb---funnel-plot-2">Publication Bias (PB) - Funnel Plot</a></li>
  <li><a href="#publication-bias-pb---funnel-plot-3" id="toc-publication-bias-pb---funnel-plot-3" class="nav-link" data-scroll-target="#publication-bias-pb---funnel-plot-3">Publication Bias (PB) - Funnel Plot</a></li>
  <li><a href="#publication-bias-pb---funnel-plot-4" id="toc-publication-bias-pb---funnel-plot-4" class="nav-link" data-scroll-target="#publication-bias-pb---funnel-plot-4">Publication Bias (PB) - Funnel Plot</a></li>
  <li><a href="#robustness-to-pb---fail-safe-n" id="toc-robustness-to-pb---fail-safe-n" class="nav-link" data-scroll-target="#robustness-to-pb---fail-safe-n">Robustness to PB - Fail-safe N</a></li>
  <li><a href="#robustness-to-pb---fail-safe-n-1" id="toc-robustness-to-pb---fail-safe-n-1" class="nav-link" data-scroll-target="#robustness-to-pb---fail-safe-n-1">Robustness to PB - Fail-safe N</a></li>
  <li><a href="#detecting-pb---egger-regression" id="toc-detecting-pb---egger-regression" class="nav-link" data-scroll-target="#detecting-pb---egger-regression">Detecting PB - Egger Regression</a></li>
  <li><a href="#publication-bias-pb---egger-regression" id="toc-publication-bias-pb---egger-regression" class="nav-link" data-scroll-target="#publication-bias-pb---egger-regression">Publication Bias (PB) - Egger Regression</a></li>
  <li><a href="#correcting-pb---trim-and-fill" id="toc-correcting-pb---trim-and-fill" class="nav-link" data-scroll-target="#correcting-pb---trim-and-fill">Correcting PB - Trim and Fill</a></li>
  <li><a href="#correcting-pb---trim-and-fill-1" id="toc-correcting-pb---trim-and-fill-1" class="nav-link" data-scroll-target="#correcting-pb---trim-and-fill-1">Correcting PB - Trim and Fill</a></li>
  <li><a href="#correcting-pb---trim-and-fill-2" id="toc-correcting-pb---trim-and-fill-2" class="nav-link" data-scroll-target="#correcting-pb---trim-and-fill-2">Correcting PB - Trim and Fill</a></li>
  <li><a href="#correcting-pb---selection-models-sm" id="toc-correcting-pb---selection-models-sm" class="nav-link" data-scroll-target="#correcting-pb---selection-models-sm">Correcting PB - Selection Models (SM)</a></li>
  <li><a href="#sm---publication-bias-function" id="toc-sm---publication-bias-function" class="nav-link" data-scroll-target="#sm---publication-bias-function">SM - Publication Bias Function</a></li>
  <li><a href="#sm---publication-bias-function-1" id="toc-sm---publication-bias-function-1" class="nav-link" data-scroll-target="#sm---publication-bias-function-1">SM - Publication Bias Function</a></li>
  <li><a href="#sec-pub-bias-fun" id="toc-sec-pub-bias-fun" class="nav-link" data-scroll-target="#sec-pub-bias-fun">SM - Publication Bias Function</a></li>
  <li><a href="#selection-models" id="toc-selection-models" class="nav-link" data-scroll-target="#selection-models">Selection Models</a></li>
  <li><a href="#selection-models-1" id="toc-selection-models-1" class="nav-link" data-scroll-target="#selection-models-1">Selection Models</a></li>
  <li><a href="#more-on-sm-and-publication-bias" id="toc-more-on-sm-and-publication-bias" class="nav-link" data-scroll-target="#more-on-sm-and-publication-bias">More on SM and Publication Bias</a></li>
  <li><a href="#more-on-sm-and-publication-bias-1" id="toc-more-on-sm-and-publication-bias-1" class="nav-link" data-scroll-target="#more-on-sm-and-publication-bias-1">More on SM and Publication Bias</a></li>
  <li><a href="#extra---simulating-publication-bias" id="toc-extra---simulating-publication-bias" class="nav-link" data-scroll-target="#extra---simulating-publication-bias">Extra - Simulating Publication Bias</a></li>
  <li><a href="#extra---simulating-publication-bias-1" id="toc-extra---simulating-publication-bias-1" class="nav-link" data-scroll-target="#extra---simulating-publication-bias-1">Extra - Simulating Publication Bias</a></li>
  <li><a href="#extra---simulating-publication-bias-2" id="toc-extra---simulating-publication-bias-2" class="nav-link" data-scroll-target="#extra---simulating-publication-bias-2">Extra - Simulating Publication Bias</a></li>
  <li><a href="#extra---simulating-publication-bias-3" id="toc-extra---simulating-publication-bias-3" class="nav-link" data-scroll-target="#extra---simulating-publication-bias-3">Extra - Simulating Publication Bias</a></li>
  <li><a href="#extra---simulating-publication-bias-4" id="toc-extra---simulating-publication-bias-4" class="nav-link" data-scroll-target="#extra---simulating-publication-bias-4">Extra - Simulating Publication Bias</a></li>
  <li><a href="#extra---simulating-publication-bias-5" id="toc-extra---simulating-publication-bias-5" class="nav-link" data-scroll-target="#extra---simulating-publication-bias-5">Extra - Simulating Publication Bias</a></li>
  </ul></li>
  <li><a href="#practical-meta-analysis" id="toc-practical-meta-analysis" class="nav-link" data-scroll-target="#practical-meta-analysis">Practical meta-analysis</a>
  <ul class="collapse">
  <li><a href="#oliveira2023-yf-dataset" id="toc-oliveira2023-yf-dataset" class="nav-link" data-scroll-target="#oliveira2023-yf-dataset"><span class="citation" data-cites="Oliveira2023-yf">Oliveira et al. (2023)</span> dataset</a></li>
  <li><a href="#oliveira2023-yf-dataset-1" id="toc-oliveira2023-yf-dataset-1" class="nav-link" data-scroll-target="#oliveira2023-yf-dataset-1"><span class="citation" data-cites="Oliveira2023-yf">Oliveira et al. (2023)</span> dataset</a></li>
  <li><a href="#steps" id="toc-steps" class="nav-link" data-scroll-target="#steps">Steps</a></li>
  <li><a href="#dear2019-qc-dataset" id="toc-dear2019-qc-dataset" class="nav-link" data-scroll-target="#dear2019-qc-dataset"><span class="citation" data-cites="Dear2019-qc">Dear, Dutton, and Fox (2019)</span> dataset</a></li>
  <li><a href="#dear2019-qc-dataset-1" id="toc-dear2019-qc-dataset-1" class="nav-link" data-scroll-target="#dear2019-qc-dataset-1"><span class="citation" data-cites="Dear2019-qc">Dear, Dutton, and Fox (2019)</span> dataset</a></li>
  <li><a href="#steps-1" id="toc-steps-1" class="nav-link" data-scroll-target="#steps-1">Steps</a></li>
  <li><a href="#references-download-.bib-file" id="toc-references-download-.bib-file" class="nav-link" data-scroll-target="#references-download-.bib-file">References </a><button class="btn"><a href="#references-download-.bib-file" id="toc-references-download-.bib-file" class="nav-link" data-scroll-target="#references-download-.bib-file"><i class="fa fa-download"></i></a><a href="data:text/x-bibtex;base64,QEFSVElDTEV7U2hpMjAxOS1waiwKICB0aXRsZSAgICAgPSAiVGhlIHRyaW0tYW5kLWZpbGwgbWV0aG9kIGZvciBwdWJsaWNhdGlvbiBiaWFzOiBwcmFjdGljYWwKICAgICAgICAgICAgICAgZ3VpZGVsaW5lcyBhbmQgcmVjb21tZW5kYXRpb25zIGJhc2VkIG9uIGEgbGFyZ2UgZGF0YWJhc2Ugb2YKICAgICAgICAgICAgICAgbWV0YS1hbmFseXNlczogcHJhY3RpY2FsIGd1aWRlbGluZXMgYW5kIHJlY29tbWVuZGF0aW9ucyBiYXNlZCBvbgogICAgICAgICAgICAgICBhIGxhcmdlIGRhdGFiYXNlIG9mIG1ldGEtYW5hbHlzZXMiLAogIGF1dGhvciAgICA9ICJTaGksIExpbnl1IGFuZCBMaW4sIExpZmVuZyIsCiAgam91cm5hbCAgID0gIk1lZGljaW5lIChCYWx0aW1vcmUpIiwKICBwdWJsaXNoZXIgPSAiT3ZpZCBUZWNobm9sb2dpZXMgKFdvbHRlcnMgS2x1d2VyIEhlYWx0aCkiLAogIHZvbHVtZSAgICA9ICA5OCwKICBudW1iZXIgICAgPSAgMjMsCiAgcGFnZXMgICAgID0gImUxNTk4NyIsCiAgbW9udGggICAgID0gIGp1biwKICB5ZWFyICAgICAgPSAgMjAxOSwKICBsYW5ndWFnZSAgPSAiZW4iLAogIGlzc24gICAgICA9ICIwMDI1LTc5NzQsIDE1MzYtNTk2NCIsCiAgcG1pZCAgICAgID0gIjMxMTY5NzM2IiwKICBkb2kgICAgICAgPSAiMTAuMTA5Ny9NRC4wMDAwMDAwMDAwMDE1OTg3IiwKICBwbWMgICAgICAgPSAiUE1DNjU3MTM3MiIKfQoKQEFSVElDTEV7VmllY2h0YmF1ZXIyMDA1LXp0LAogIHRpdGxlICAgICA9ICJCaWFzIGFuZCBlZmZpY2llbmN5IG9mIG1ldGEtYW5hbHl0aWMgdmFyaWFuY2UgZXN0aW1hdG9ycyBpbiB0aGUKICAgICAgICAgICAgICAgcmFuZG9tLWVmZmVjdHMgbW9kZWwiLAogIGF1dGhvciAgICA9ICJWaWVjaHRiYXVlciwgV29sZmdhbmciLAogIGpvdXJuYWwgICA9ICJKLiBFZHVjLiBCZWhhdi4gU3RhdC4iLAogIHB1Ymxpc2hlciA9ICJBbWVyaWNhbiBFZHVjYXRpb25hbCBSZXNlYXJjaCBBc3NvY2lhdGlvbiAoQUVSQSkiLAogIHZvbHVtZSAgICA9ICAzMCwKICBudW1iZXIgICAgPSAgMywKICBwYWdlcyAgICAgPSAiMjYxLTI5MyIsCiAgbW9udGggICAgID0gIHNlcCwKICB5ZWFyICAgICAgPSAgMjAwNSwKICBsYW5ndWFnZSAgPSAiZW4iLAogIGlzc24gICAgICA9ICIxMDc2LTk5ODYsIDE5MzUtMTA1NCIsCiAgZG9pICAgICAgID0gIjEwLjMxMDIvMTA3Njk5ODYwMzAwMDMyNjEiCn0KCkBBUlRJQ0xFe1Jvc2VudGhhbDE5NzkteXgsCiAgdGl0bGUgICAgID0gIlRoZSBmaWxlIGRyYXdlciBwcm9ibGVtIGFuZCB0b2xlcmFuY2UgZm9yIG51bGwgcmVzdWx0cyIsCiAgYXV0aG9yICAgID0gIlJvc2VudGhhbCwgUm9iZXJ0IiwKICBqb3VybmFsICAgPSAiUHN5Y2hvbC4gQnVsbC4iLAogIHB1Ymxpc2hlciA9ICJBbWVyaWNhbiBQc3ljaG9sb2dpY2FsIEFzc29jaWF0aW9uIChBUEEpIiwKICB2b2x1bWUgICAgPSAgODYsCiAgbnVtYmVyICAgID0gIDMsCiAgcGFnZXMgICAgID0gIjYzOC02NDEiLAogIG1vbnRoICAgICA9ICBtYXksCiAgeWVhciAgICAgID0gIDE5NzksCiAgbGFuZ3VhZ2UgID0gImVuIiwKICBpc3NuICAgICAgPSAiMDAzMy0yOTA5LCAxOTM5LTE0NTUiLAogIGRvaSAgICAgICA9ICIxMC4xMDM3LzAwMzMtMjkwOS44Ni4zLjYzOCIKfQoKQEFSVElDTEV7T3J3aW4xOTgzLXZ1LAogIHRpdGxlICAgICA9ICJBIHtmYWlsLVNhZmVOfSBmb3IgZWZmZWN0IHNpemUgaW4gbWV0YS1hbmFseXNpcyIsCiAgYXV0aG9yICAgID0gIk9yd2luLCBSb2JlcnQgRyIsCiAgam91cm5hbCAgID0gIkouIEVkdWMuIFN0YXQuIiwKICBwdWJsaXNoZXIgPSAiQW1lcmljYW4gRWR1Y2F0aW9uYWwgUmVzZWFyY2ggQXNzb2NpYXRpb24gKEFFUkEpIiwKICB2b2x1bWUgICAgPSAgOCwKICBudW1iZXIgICAgPSAgMiwKICBwYWdlcyAgICAgPSAiMTU3LTE1OSIsCiAgbW9udGggICAgID0gIGp1biwKICB5ZWFyICAgICAgPSAgMTk4MywKICBsYW5ndWFnZSAgPSAiZW4iLAogIGlzc24gICAgICA9ICIwMzYyLTk3OTEsIDIzMjgtMDczNSIsCiAgZG9pICAgICAgID0gIjEwLjMxMDIvMTA3Njk5ODYwMDgwMDIxNTciCn0KCkBBUlRJQ0xFe1Jvc2VuYmVyZzIwMDUtaWUsCiAgdGl0bGUgICAgID0gIlRoZSBmaWxlLWRyYXdlciBwcm9ibGVtIHJldmlzaXRlZDogYSBnZW5lcmFsIHdlaWdodGVkIG1ldGhvZCBmb3IKICAgICAgICAgICAgICAgY2FsY3VsYXRpbmcgZmFpbC1zYWZlIG51bWJlcnMgaW4gbWV0YS1hbmFseXNpcyIsCiAgYXV0aG9yICAgID0gIlJvc2VuYmVyZywgTWljaGFlbCBTIiwKICBqb3VybmFsICAgPSAiRXZvbHV0aW9uIiwKICBwdWJsaXNoZXIgPSAiV2lsZXkiLAogIHZvbHVtZSAgICA9ICA1OSwKICBudW1iZXIgICAgPSAgMiwKICBwYWdlcyAgICAgPSAiNDY0LTQ2OCIsCiAgbW9udGggICAgID0gIGZlYiwKICB5ZWFyICAgICAgPSAgMjAwNSwKICBsYW5ndWFnZSAgPSAiZW4iLAogIGlzc24gICAgICA9ICIwMDE0LTM4MjAsIDE1NTgtNTY0NiIsCiAgcG1pZCAgICAgID0gIjE1ODA3NDMwIiwKICBkb2kgICAgICAgPSAiMTAuMTExMS9qLjAwMTQtMzgyMC4yMDA1LnRiMDEwMDQueCIKfQoKQEFSVElDTEV7Q2l0a293aWN6MjAxNy1veCwKICB0aXRsZSAgICAgPSAiQSBwYXJzaW1vbmlvdXMgd2VpZ2h0IGZ1bmN0aW9uIGZvciBtb2RlbGluZyBwdWJsaWNhdGlvbiBiaWFzIiwKICBhdXRob3IgICAgPSAiQ2l0a293aWN6LCBNYXJ0eW5hIGFuZCBWZXZlYSwgSmFjayBMIiwKICBqb3VybmFsICAgPSAiUHN5Y2hvbC4gTWV0aG9kcyIsCiAgcHVibGlzaGVyID0gInBzeWNuZXQuYXBhLm9yZyIsCiAgdm9sdW1lICAgID0gIDIyLAogIG51bWJlciAgICA9ICAxLAogIHBhZ2VzICAgICA9ICIyOC00MSIsCiAgbW9udGggICAgID0gIG1hciwKICB5ZWFyICAgICAgPSAgMjAxNywKICBsYW5ndWFnZSAgPSAiZW4iLAogIGlzc24gICAgICA9ICIxMDgyLTk4OVgsIDE5MzktMTQ2MyIsCiAgcG1pZCAgICAgID0gIjI4MjUyOTk4IiwKICBkb2kgICAgICAgPSAiMTAuMTAzNy9tZXQwMDAwMTE5Igp9CgpAQVJUSUNMRXtNY1NoYW5lMjAxNi1iaywKICB0aXRsZSAgICAgPSAiQWRqdXN0aW5nIGZvciBwdWJsaWNhdGlvbiBiaWFzIGluIG1ldGEtYW5hbHlzaXM6IEFuIGV2YWx1YXRpb24KICAgICAgICAgICAgICAgb2Ygc2VsZWN0aW9uIG1ldGhvZHMgYW5kIHNvbWUgY2F1dGlvbmFyeSBub3RlczogQW4gZXZhbHVhdGlvbiBvZgogICAgICAgICAgICAgICBzZWxlY3Rpb24gbWV0aG9kcyBhbmQgc29tZSBjYXV0aW9uYXJ5IG5vdGVzIiwKICBhdXRob3IgICAgPSAiTWNTaGFuZSwgQmxha2VsZXkgQiBhbmQgQntcIm99Y2tlbmhvbHQsIFVsZiBhbmQgSGFuc2VuLCBLYXJzdGVuCiAgICAgICAgICAgICAgIFQiLAogIGpvdXJuYWwgICA9ICJQZXJzcGVjdC4gUHN5Y2hvbC4gU2NpLiIsCiAgcHVibGlzaGVyID0gIlNBR0UgUHVibGljYXRpb25zIiwKICB2b2x1bWUgICAgPSAgMTEsCiAgbnVtYmVyICAgID0gIDUsCiAgcGFnZXMgICAgID0gIjczMC03NDkiLAogIG1vbnRoICAgICA9ICBzZXAsCiAgeWVhciAgICAgID0gIDIwMTYsCiAgbGFuZ3VhZ2UgID0gImVuIiwKICBpc3NuICAgICAgPSAiMTc0NS02OTE2LCAxNzQ1LTY5MjQiLAogIHBtaWQgICAgICA9ICIyNzY5NDQ2NyIsCiAgZG9pICAgICAgID0gIjEwLjExNzcvMTc0NTY5MTYxNjY2MjI0MyIKfQoKQEFSVElDTEV7QmFydG9zMjAyMi1pbSwKICB0aXRsZSAgICAgPSAiQWRqdXN0aW5nIGZvciBwdWJsaWNhdGlvbiBiaWFzIGluIHtKQVNQfSBhbmQgUjogU2VsZWN0aW9uCiAgICAgICAgICAgICAgIG1vZGVscywge1BFVC1QRUVTRX0sIGFuZCByb2J1c3QgQmF5ZXNpYW4gbWV0YS1hbmFseXNpcyIsCiAgYXV0aG9yICAgID0gIkJhcnRve1x2IHN9LCBGcmFudGl7XHYgc31layBhbmQgTWFpZXIsIE1heGltaWxpYW4gYW5kIFF1aW50YW5hLAogICAgICAgICAgICAgICBEYW5pZWwgUyBhbmQgV2FnZW5tYWtlcnMsIEVyaWMtSmFuIiwKICBqb3VybmFsICAgPSAiQWR2LiBNZXRob2RzIFByYWN0LiBQc3ljaG9sLiBTY2kuIiwKICBwdWJsaXNoZXIgPSAiU0FHRSBQdWJsaWNhdGlvbnMiLAogIHZvbHVtZSAgICA9ICA1LAogIG51bWJlciAgICA9ICAzLAogIHBhZ2VzICAgICA9ICIyNTE1MjQ1OTIyMTEwOTIiLAogIG1vbnRoICAgICA9ICBqdWwsCiAgeWVhciAgICAgID0gIDIwMjIsCiAgbGFuZ3VhZ2UgID0gImVuIiwKICBpc3NuICAgICAgPSAiMjUxNS0yNDU5LCAyNTE1LTI0NjciLAogIGRvaSAgICAgICA9ICIxMC4xMTc3LzI1MTUyNDU5MjIxMTA5MjU5Igp9CgpAQVJUSUNMRXtNYWllcjIwMjMtanMsCiAgdGl0bGUgICAgPSAiUm9idXN0IEJheWVzaWFuIG1ldGEtYW5hbHlzaXM6IEFkZHJlc3NpbmcgcHVibGljYXRpb24gYmlhcyB3aXRoCiAgICAgICAgICAgICAgbW9kZWwtYXZlcmFnaW5nIiwKICBhdXRob3IgICA9ICJNYWllciwgTWF4aW1pbGlhbiBhbmQgQmFydG97XHYgc30sIEZyYW50aXtcdiBzfWVrIGFuZAogICAgICAgICAgICAgIFdhZ2VubWFrZXJzLCBFcmljLUphbiIsCiAgam91cm5hbCAgPSAiUHN5Y2hvbC4gTWV0aG9kcyIsCiAgdm9sdW1lICAgPSAgMjgsCiAgbnVtYmVyICAgPSAgMSwKICBwYWdlcyAgICA9ICIxMDctMTIyIiwKICBtb250aCAgICA9ICBmZWIsCiAgeWVhciAgICAgPSAgMjAyMywKICBsYW5ndWFnZSA9ICJlbiIsCiAgaXNzbiAgICAgPSAiMTA4Mi05ODlYLCAxOTM5LTE0NjMiLAogIHBtaWQgICAgID0gIjM1NTg4MDc1IiwKICBkb2kgICAgICA9ICIxMC4xMDM3L21ldDAwMDA0MDUiCn0KCkBNSVNDe1ZpZWNodGJhdWVyMjAyMS1vZCwKICB0aXRsZSAgICAgPSAiU2VsZWN0aW9uIG1vZGVscyBmb3IgcHVibGljYXRpb24gYmlhcyBpbiBtZXRhLWFuYWx5c2lzLgogICAgICAgICAgICAgICBQcmVzZW50YXRpb24gYXQge0VTTUFSQ29uZjIwMjF9IiwKICBhdXRob3IgICAgPSAiVmllY2h0YmF1ZXIsIFdvbGZnYW5nIiwKICBwdWJsaXNoZXIgPSAiZmlnc2hhcmUiLAogIG1vbnRoICAgICA9ICBqYW4sCiAgeWVhciAgICAgID0gIDIwMjEsCiAgZG9pICAgICAgID0gIjEwLjYwODQvTTkuRklHU0hBUkUuMTM2Mzc5MDAuVjEiCn0KCkBBUlRJQ0xFe0hlZGdlczIwMjEtb2YsCiAgdGl0bGUgICAgID0gIlRoZSBEZXNpZ24gb2YgUmVwbGljYXRpb24gU3R1ZGllcyIsCiAgYXV0aG9yICAgID0gIkhlZGdlcywgTGFycnkgViBhbmQgU2NoYXVlciwgSmFjb2IgTSIsCiAgam91cm5hbCAgID0gIkouIFIuIFN0YXQuIFNvYy4gU2VyLiBBIFN0YXQuIFNvYy4iLAogIHB1Ymxpc2hlciA9ICJPeGZvcmQgQWNhZGVtaWMiLAogIHZvbHVtZSAgICA9ICAxODQsCiAgbnVtYmVyICAgID0gIDMsCiAgcGFnZXMgICAgID0gIjg2OC04ODYiLAogIG1vbnRoICAgICA9ICBtYXIsCiAgeWVhciAgICAgID0gIDIwMjEsCiAgY29weXJpZ2h0ID0gImh0dHBzOi8vYWNhZGVtaWMub3VwLmNvbS9qb3VybmFscy9wYWdlcy9vcGVuXF9hY2Nlc3MvZnVuZGVyXF9wb2xpY2llcy9jaG9ydXMvc3RhbmRhcmRcX3B1YmxpY2F0aW9uXF9tb2RlbCIsCiAgbGFuZ3VhZ2UgID0gImVuIiwKICBpc3NuICAgICAgPSAiMDk2NC0xOTk4LCAxNDY3LTk4NVgiLAogIGRvaSAgICAgICA9ICIxMC4xMTExL3Jzc2EuMTI2ODgiCn0KCkBBUlRJQ0xFe09saXZlaXJhMjAyMy15ZiwKICB0aXRsZSAgICAgPSAiSW50ZXJuZXQtZGVsaXZlcmVkIGNvZ25pdGl2ZSBiZWhhdmlvcmFsIHRoZXJhcHkgZm9yIGFueGlldHkKICAgICAgICAgICAgICAgYW1vbmcgdW5pdmVyc2l0eSBzdHVkZW50czogQSBzeXN0ZW1hdGljIHJldmlldyBhbmQgbWV0YS1hbmFseXNpcyIsCiAgYXV0aG9yICAgID0gIk9saXZlaXJhLCBDbHtcJ2F9dWRpYSBhbmQgUGFjaGVjbywgTWFyYSBhbmQgQm9yZ2VzLCBKYW5ldGUgYW5kCiAgICAgICAgICAgICAgIE1laXJhLCBMaWxpYW5hIGFuZCBTYW50b3MsIEFuaXRhIiwKICBqb3VybmFsICAgPSAiSW50ZXJuZXQgSW50ZXJ2LiIsCiAgcHVibGlzaGVyID0gIkVsc2V2aWVyIEJWIiwKICB2b2x1bWUgICAgPSAgMzEsCiAgbnVtYmVyICAgID0gIDEwMDYwOSwKICBwYWdlcyAgICAgPSAiMTAwNjA5IiwKICBtb250aCAgICAgPSAgbWFyLAogIHllYXIgICAgICA9ICAyMDIzLAogIGNvcHlyaWdodCA9ICJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS1uYy1uZC80LjAvIiwKICBsYW5ndWFnZSAgPSAiZW4iLAogIGlzc24gICAgICA9ICIyMjE0LTc4MjkiLAogIHBtaWQgICAgICA9ICIzNjg3MzMwNyIsCiAgZG9pICAgICAgID0gIjEwLjEwMTYvai5pbnZlbnQuMjAyMy4xMDA2MDkiLAogIHBtYyAgICAgICA9ICJQTUM5OTgyNjQyIgp9CgpAQVJUSUNMRXtEZWFyMjAxOS1xYywKICB0aXRsZSAgICAgPSAiRG8gYHdhdGNoaW5nIGV5ZXMnIGluZmx1ZW5jZSBhbnRpc29jaWFsIGJlaGF2aW9yPyBBIHN5c3RlbWF0aWMKICAgICAgICAgICAgICAgcmV2aWV3IFwmIG1ldGEtYW5hbHlzaXMiLAogIGF1dGhvciAgICA9ICJEZWFyLCBLZWl0aCBhbmQgRHV0dG9uLCBLZXZpbiBhbmQgRm94LCBFbGFpbmUiLAogIGpvdXJuYWwgICA9ICJFdm9sLiBIdW0uIEJlaGF2LiIsCiAgcHVibGlzaGVyID0gIkVsc2V2aWVyIEJWIiwKICB2b2x1bWUgICAgPSAgNDAsCiAgbnVtYmVyICAgID0gIDMsCiAgcGFnZXMgICAgID0gIjI2OS0yODAiLAogIG1vbnRoICAgICA9ICBtYXksCiAgeWVhciAgICAgID0gIDIwMTksCiAgY29weXJpZ2h0ID0gImh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLW5kLzQuMC8iLAogIGxhbmd1YWdlICA9ICJlbiIsCiAgaXNzbiAgICAgID0gIjEwOTAtNTEzOCwgMTg3OS0wNjA3IiwKICBkb2kgICAgICAgPSAiMTAuMTAxNi9qLmV2b2xodW1iZWhhdi4yMDE5LjAxLjAwNiIKfQoKQEFSVElDTEV7R3VhbjIwMTYta24sCiAgdGl0bGUgICAgPSAiQSBCYXllc2lhbiBhcHByb2FjaCB0byBtaXRpZ2F0aW9uIG9mIHB1YmxpY2F0aW9uIGJpYXMiLAogIGF1dGhvciAgID0gIkd1YW4sIE1haW1lIGFuZCBWYW5kZWtlcmNraG92ZSwgSm9hY2hpbSIsCiAgam91cm5hbCAgPSAiUHN5Y2hvbi4gQnVsbC4gUmV2LiIsCiAgdm9sdW1lICAgPSAgMjMsCiAgbnVtYmVyICAgPSAgMSwKICBwYWdlcyAgICA9ICI3NC04NiIsCiAgbW9udGggICAgPSAgZmViLAogIHllYXIgICAgID0gIDIwMTYsCiAgbGFuZ3VhZ2UgPSAiZW4iLAogIGlzc24gICAgID0gIjEwNjktOTM4NCwgMTUzMS01MzIwIiwKICBwbWlkICAgICA9ICIyNjEyNjc3NiIsCiAgZG9pICAgICAgPSAiMTAuMzc1OC9zMTM0MjMtMDE1LTA4NjgtNiIKfQoKQEJPT0t7SGFycmVyMjAyMS1nbywKICB0aXRsZSAgICAgPSAiRG9pbmcgbWV0YS1hbmFseXNpcyB3aXRoIFI6IEEgaGFuZHMtb24gZ3VpZGUiLAogIGF1dGhvciAgICA9ICJIYXJyZXIsIE1hdGhpYXMgYW5kIEN1aWpwZXJzLCBQaW0gYW5kIEZ1cnVrYXdhLCBUb3NoaSBhbmQgRWJlcnQsCiAgICAgICAgICAgICAgIERhdmlkIiwKICBwdWJsaXNoZXIgPSAiQ1JDIFByZXNzIiwKICBlZGl0aW9uICAgPSAiMXN0IiwKICBtb250aCAgICAgPSAgc2VwLAogIHllYXIgICAgICA9ICAyMDIxLAogIGFkZHJlc3MgICA9ICJMb25kb24sIEVuZ2xhbmQiLAogIGxhbmd1YWdlICA9ICJlbiIsCiAgaXNibiAgICAgID0gIjk3ODAzNjc2MTAwNzQiCn0KCkBBUlRJQ0xFe0R1dmFsMjAwMC15bSwKICB0aXRsZSAgICAgPSAiVHJpbSBhbmQgZmlsbDogQSBzaW1wbGUgZnVubmVsLXBsb3QtYmFzZWQgbWV0aG9kIG9mIHRlc3RpbmcgYW5kCiAgICAgICAgICAgICAgIGFkanVzdGluZyBmb3IgcHVibGljYXRpb24gYmlhcyBpbiBtZXRhLWFuYWx5c2lzIiwKICBhdXRob3IgICAgPSAiRHV2YWwsIFMgYW5kIFR3ZWVkaWUsIFIiLAogIGpvdXJuYWwgICA9ICJCaW9tZXRyaWNzIiwKICBwdWJsaXNoZXIgPSAiV2lsZXkiLAogIHZvbHVtZSAgICA9ICA1NiwKICBudW1iZXIgICAgPSAgMiwKICBwYWdlcyAgICAgPSAiNDU1LTQ2MyIsCiAgbW9udGggICAgID0gIGp1biwKICB5ZWFyICAgICAgPSAgMjAwMCwKICBsYW5ndWFnZSAgPSAiZW4iLAogIGlzc24gICAgICA9ICIwMDA2LTM0MVgsIDE1NDEtMDQyMCIsCiAgcG1pZCAgICAgID0gIjEwODc3MzA0IiwKICBkb2kgICAgICAgPSAiMTAuMTExMS9qLjAwMDYtMzQxeC4yMDAwLjAwNDU1LngiCn0KCkBNSVNDe1ZpZWNodGJhdWVyMjAxMC14eiwKICB0aXRsZSAgID0gIkNvbmR1Y3RpbmcgbWV0YS1hbmFseXNlcyBpbiB7Un0gd2l0aCB0aGUge21ldGFmb3J9IHBhY2thZ2UiLAogIGF1dGhvciAgPSAiVmllY2h0YmF1ZXIsIFdvbGZnYW5nIiwKICBqb3VybmFsID0gIkpvdXJuYWwgb2YgU3RhdGlzdGljYWwgU29mdHdhcmUiLAogIHZvbHVtZSAgPSAgMzYsCiAgbnVtYmVyICA9ICAzLAogIHBhZ2VzICAgPSAiMS00OCIsCiAgeWVhciAgICA9ICAyMDEwLAogIGRvaSAgICAgPSAiMTAuMTg2MzcvanNzLnYwMzYuaTAzIgp9CgpATUlTQ3tCb3JlbnN0ZWluMjAwOS1tbywKICB0aXRsZSAgPSAiSW50cm9kdWN0aW9uIHRvIHtNZXRhLUFuYWx5c2lzfSIsCiAgYXV0aG9yID0gIkJvcmVuc3RlaW4sIE1pY2hhZWwgYW5kIEhlZGdlcywgTGFycnkgViBhbmQgSGlnZ2lucywgSnVsaWFuIFAgVCBhbmQKICAgICAgICAgICAgUm90aHN0ZWluLCBIYW5uYWggUiIsCiAgeWVhciAgID0gIDIwMDksCiAgZG9pICAgID0gIjEwLjEwMDIvOTc4MDQ3MDc0MzM4NiIKfQoKQEFSVElDTEV7SGlnZ2luczIwMDItZmgsCiAgdGl0bGUgICAgPSAiUXVhbnRpZnlpbmcgaGV0ZXJvZ2VuZWl0eSBpbiBhIG1ldGEtYW5hbHlzaXMiLAogIGF1dGhvciAgID0gIkhpZ2dpbnMsIEp1bGlhbiBQIFQgYW5kIFRob21wc29uLCBTaW1vbiBHIiwKICBqb3VybmFsICA9ICJTdGF0LiBNZWQuIiwKICB2b2x1bWUgICA9ICAyMSwKICBudW1iZXIgICA9ICAxMSwKICBwYWdlcyAgICA9ICIxNTM5LTE1NTgiLAogIG1vbnRoICAgID0gIGp1biwKICB5ZWFyICAgICA9ICAyMDAyLAogIGxhbmd1YWdlID0gImVuIiwKICBpc3NuICAgICA9ICIwMjc3LTY3MTUiLAogIHBtaWQgICAgID0gIjEyMTExOTE5IiwKICBkb2kgICAgICA9ICIxMC4xMDAyL3NpbS4xMTg2Igp9CgpAQVJUSUNMRXtIZWRnZXMyMDE5LXJ5LAogIHRpdGxlICAgICA9ICJTdGF0aXN0aWNhbCBhbmFseXNlcyBmb3Igc3R1ZHlpbmcgcmVwbGljYXRpb246IE1ldGEtYW5hbHl0aWMKICAgICAgICAgICAgICAgcGVyc3BlY3RpdmVzIiwKICBhdXRob3IgICAgPSAiSGVkZ2VzLCBMYXJyeSBWIGFuZCBTY2hhdWVyLCBKYWNvYiBNIiwKICBqb3VybmFsICAgPSAiUHN5Y2hvbC4gTWV0aG9kcyIsCiAgcHVibGlzaGVyID0gIkFtZXJpY2FuIFBzeWNob2xvZ2ljYWwgQXNzb2NpYXRpb24gKEFQQSkiLAogIHZvbHVtZSAgICA9ICAyNCwKICBudW1iZXIgICAgPSAgNSwKICBwYWdlcyAgICAgPSAiNTU3LTU3MCIsCiAgbW9udGggICAgID0gIG9jdCwKICB5ZWFyICAgICAgPSAgMjAxOSwKICBsYW5ndWFnZSAgPSAiZW4iLAogIGlzc24gICAgICA9ICIxMDgyLTk4OVgsIDE5MzktMTQ2MyIsCiAgcG1pZCAgICAgID0gIjMwMDcwNTQ3IiwKICBkb2kgICAgICAgPSAiMTAuMTAzNy9tZXQwMDAwMTg5Igp9Cgo=" download="refs_to_download.bib" class="nav-link" data-scroll-target="data\:text/x-bibtex;base64,QEFSVElDTEV7U2hpMjAxOS1waiwKICB0aXRsZSAgICAgPSAiVGhlIHRyaW0tYW5kLWZpbGwgbWV0aG9kIGZvciBwdWJsaWNhdGlvbiBiaWFzOiBwcmFjdGljYWwKICAgICAgICAgICAgICAgZ3VpZGVsaW5lcyBhbmQgcmVjb21tZW5kYXRpb25zIGJhc2VkIG9uIGEgbGFyZ2UgZGF0YWJhc2Ugb2YKICAgICAgICAgICAgICAgbWV0YS1hbmFseXNlczogcHJhY3RpY2FsIGd1aWRlbGluZXMgYW5kIHJlY29tbWVuZGF0aW9ucyBiYXNlZCBvbgogICAgICAgICAgICAgICBhIGxhcmdlIGRhdGFiYXNlIG9mIG1ldGEtYW5hbHlzZXMiLAogIGF1dGhvciAgICA9ICJTaGksIExpbnl1IGFuZCBMaW4sIExpZmVuZyIsCiAgam91cm5hbCAgID0gIk1lZGljaW5lIChCYWx0aW1vcmUpIiwKICBwdWJsaXNoZXIgPSAiT3ZpZCBUZWNobm9sb2dpZXMgKFdvbHRlcnMgS2x1d2VyIEhlYWx0aCkiLAogIHZvbHVtZSAgICA9ICA5OCwKICBudW1iZXIgICAgPSAgMjMsCiAgcGFnZXMgICAgID0gImUxNTk4NyIsCiAgbW9udGggICAgID0gIGp1biwKICB5ZWFyICAgICAgPSAgMjAxOSwKICBsYW5ndWFnZSAgPSAiZW4iLAogIGlzc24gICAgICA9ICIwMDI1LTc5NzQsIDE1MzYtNTk2NCIsCiAgcG1pZCAgICAgID0gIjMxMTY5NzM2IiwKICBkb2kgICAgICAgPSAiMTAuMTA5Ny9NRC4wMDAwMDAwMDAwMDE1OTg3IiwKICBwbWMgICAgICAgPSAiUE1DNjU3MTM3MiIKfQoKQEFSVElDTEV7VmllY2h0YmF1ZXIyMDA1LXp0LAogIHRpdGxlICAgICA9ICJCaWFzIGFuZCBlZmZpY2llbmN5IG9mIG1ldGEtYW5hbHl0aWMgdmFyaWFuY2UgZXN0aW1hdG9ycyBpbiB0aGUKICAgICAgICAgICAgICAgcmFuZG9tLWVmZmVjdHMgbW9kZWwiLAogIGF1dGhvciAgICA9ICJWaWVjaHRiYXVlciwgV29sZmdhbmciLAogIGpvdXJuYWwgICA9ICJKLiBFZHVjLiBCZWhhdi4gU3RhdC4iLAogIHB1Ymxpc2hlciA9ICJBbWVyaWNhbiBFZHVjYXRpb25hbCBSZXNlYXJjaCBBc3NvY2lhdGlvbiAoQUVSQSkiLAogIHZvbHVtZSAgICA9ICAzMCwKICBudW1iZXIgICAgPSAgMywKICBwYWdlcyAgICAgPSAiMjYxLTI5MyIsCiAgbW9udGggICAgID0gIHNlcCwKICB5ZWFyICAgICAgPSAgMjAwNSwKICBsYW5ndWFnZSAgPSAiZW4iLAogIGlzc24gICAgICA9ICIxMDc2LTk5ODYsIDE5MzUtMTA1NCIsCiAgZG9pICAgICAgID0gIjEwLjMxMDIvMTA3Njk5ODYwMzAwMDMyNjEiCn0KCkBBUlRJQ0xFe1Jvc2VudGhhbDE5NzkteXgsCiAgdGl0bGUgICAgID0gIlRoZSBmaWxlIGRyYXdlciBwcm9ibGVtIGFuZCB0b2xlcmFuY2UgZm9yIG51bGwgcmVzdWx0cyIsCiAgYXV0aG9yICAgID0gIlJvc2VudGhhbCwgUm9iZXJ0IiwKICBqb3VybmFsICAgPSAiUHN5Y2hvbC4gQnVsbC4iLAogIHB1Ymxpc2hlciA9ICJBbWVyaWNhbiBQc3ljaG9sb2dpY2FsIEFzc29jaWF0aW9uIChBUEEpIiwKICB2b2x1bWUgICAgPSAgODYsCiAgbnVtYmVyICAgID0gIDMsCiAgcGFnZXMgICAgID0gIjYzOC02NDEiLAogIG1vbnRoICAgICA9ICBtYXksCiAgeWVhciAgICAgID0gIDE5NzksCiAgbGFuZ3VhZ2UgID0gImVuIiwKICBpc3NuICAgICAgPSAiMDAzMy0yOTA5LCAxOTM5LTE0NTUiLAogIGRvaSAgICAgICA9ICIxMC4xMDM3LzAwMzMtMjkwOS44Ni4zLjYzOCIKfQoKQEFSVElDTEV7T3J3aW4xOTgzLXZ1LAogIHRpdGxlICAgICA9ICJBIHtmYWlsLVNhZmVOfSBmb3IgZWZmZWN0IHNpemUgaW4gbWV0YS1hbmFseXNpcyIsCiAgYXV0aG9yICAgID0gIk9yd2luLCBSb2JlcnQgRyIsCiAgam91cm5hbCAgID0gIkouIEVkdWMuIFN0YXQuIiwKICBwdWJsaXNoZXIgPSAiQW1lcmljYW4gRWR1Y2F0aW9uYWwgUmVzZWFyY2ggQXNzb2NpYXRpb24gKEFFUkEpIiwKICB2b2x1bWUgICAgPSAgOCwKICBudW1iZXIgICAgPSAgMiwKICBwYWdlcyAgICAgPSAiMTU3LTE1OSIsCiAgbW9udGggICAgID0gIGp1biwKICB5ZWFyICAgICAgPSAgMTk4MywKICBsYW5ndWFnZSAgPSAiZW4iLAogIGlzc24gICAgICA9ICIwMzYyLTk3OTEsIDIzMjgtMDczNSIsCiAgZG9pICAgICAgID0gIjEwLjMxMDIvMTA3Njk5ODYwMDgwMDIxNTciCn0KCkBBUlRJQ0xFe1Jvc2VuYmVyZzIwMDUtaWUsCiAgdGl0bGUgICAgID0gIlRoZSBmaWxlLWRyYXdlciBwcm9ibGVtIHJldmlzaXRlZDogYSBnZW5lcmFsIHdlaWdodGVkIG1ldGhvZCBmb3IKICAgICAgICAgICAgICAgY2FsY3VsYXRpbmcgZmFpbC1zYWZlIG51bWJlcnMgaW4gbWV0YS1hbmFseXNpcyIsCiAgYXV0aG9yICAgID0gIlJvc2VuYmVyZywgTWljaGFlbCBTIiwKICBqb3VybmFsICAgPSAiRXZvbHV0aW9uIiwKICBwdWJsaXNoZXIgPSAiV2lsZXkiLAogIHZvbHVtZSAgICA9ICA1OSwKICBudW1iZXIgICAgPSAgMiwKICBwYWdlcyAgICAgPSAiNDY0LTQ2OCIsCiAgbW9udGggICAgID0gIGZlYiwKICB5ZWFyICAgICAgPSAgMjAwNSwKICBsYW5ndWFnZSAgPSAiZW4iLAogIGlzc24gICAgICA9ICIwMDE0LTM4MjAsIDE1NTgtNTY0NiIsCiAgcG1pZCAgICAgID0gIjE1ODA3NDMwIiwKICBkb2kgICAgICAgPSAiMTAuMTExMS9qLjAwMTQtMzgyMC4yMDA1LnRiMDEwMDQueCIKfQoKQEFSVElDTEV7Q2l0a293aWN6MjAxNy1veCwKICB0aXRsZSAgICAgPSAiQSBwYXJzaW1vbmlvdXMgd2VpZ2h0IGZ1bmN0aW9uIGZvciBtb2RlbGluZyBwdWJsaWNhdGlvbiBiaWFzIiwKICBhdXRob3IgICAgPSAiQ2l0a293aWN6LCBNYXJ0eW5hIGFuZCBWZXZlYSwgSmFjayBMIiwKICBqb3VybmFsICAgPSAiUHN5Y2hvbC4gTWV0aG9kcyIsCiAgcHVibGlzaGVyID0gInBzeWNuZXQuYXBhLm9yZyIsCiAgdm9sdW1lICAgID0gIDIyLAogIG51bWJlciAgICA9ICAxLAogIHBhZ2VzICAgICA9ICIyOC00MSIsCiAgbW9udGggICAgID0gIG1hciwKICB5ZWFyICAgICAgPSAgMjAxNywKICBsYW5ndWFnZSAgPSAiZW4iLAogIGlzc24gICAgICA9ICIxMDgyLTk4OVgsIDE5MzktMTQ2MyIsCiAgcG1pZCAgICAgID0gIjI4MjUyOTk4IiwKICBkb2kgICAgICAgPSAiMTAuMTAzNy9tZXQwMDAwMTE5Igp9CgpAQVJUSUNMRXtNY1NoYW5lMjAxNi1iaywKICB0aXRsZSAgICAgPSAiQWRqdXN0aW5nIGZvciBwdWJsaWNhdGlvbiBiaWFzIGluIG1ldGEtYW5hbHlzaXM6IEFuIGV2YWx1YXRpb24KICAgICAgICAgICAgICAgb2Ygc2VsZWN0aW9uIG1ldGhvZHMgYW5kIHNvbWUgY2F1dGlvbmFyeSBub3RlczogQW4gZXZhbHVhdGlvbiBvZgogICAgICAgICAgICAgICBzZWxlY3Rpb24gbWV0aG9kcyBhbmQgc29tZSBjYXV0aW9uYXJ5IG5vdGVzIiwKICBhdXRob3IgICAgPSAiTWNTaGFuZSwgQmxha2VsZXkgQiBhbmQgQntcIm99Y2tlbmhvbHQsIFVsZiBhbmQgSGFuc2VuLCBLYXJzdGVuCiAgICAgICAgICAgICAgIFQiLAogIGpvdXJuYWwgICA9ICJQZXJzcGVjdC4gUHN5Y2hvbC4gU2NpLiIsCiAgcHVibGlzaGVyID0gIlNBR0UgUHVibGljYXRpb25zIiwKICB2b2x1bWUgICAgPSAgMTEsCiAgbnVtYmVyICAgID0gIDUsCiAgcGFnZXMgICAgID0gIjczMC03NDkiLAogIG1vbnRoICAgICA9ICBzZXAsCiAgeWVhciAgICAgID0gIDIwMTYsCiAgbGFuZ3VhZ2UgID0gImVuIiwKICBpc3NuICAgICAgPSAiMTc0NS02OTE2LCAxNzQ1LTY5MjQiLAogIHBtaWQgICAgICA9ICIyNzY5NDQ2NyIsCiAgZG9pICAgICAgID0gIjEwLjExNzcvMTc0NTY5MTYxNjY2MjI0MyIKfQoKQEFSVElDTEV7QmFydG9zMjAyMi1pbSwKICB0aXRsZSAgICAgPSAiQWRqdXN0aW5nIGZvciBwdWJsaWNhdGlvbiBiaWFzIGluIHtKQVNQfSBhbmQgUjogU2VsZWN0aW9uCiAgICAgICAgICAgICAgIG1vZGVscywge1BFVC1QRUVTRX0sIGFuZCByb2J1c3QgQmF5ZXNpYW4gbWV0YS1hbmFseXNpcyIsCiAgYXV0aG9yICAgID0gIkJhcnRve1x2IHN9LCBGcmFudGl7XHYgc31layBhbmQgTWFpZXIsIE1heGltaWxpYW4gYW5kIFF1aW50YW5hLAogICAgICAgICAgICAgICBEYW5pZWwgUyBhbmQgV2FnZW5tYWtlcnMsIEVyaWMtSmFuIiwKICBqb3VybmFsICAgPSAiQWR2LiBNZXRob2RzIFByYWN0LiBQc3ljaG9sLiBTY2kuIiwKICBwdWJsaXNoZXIgPSAiU0FHRSBQdWJsaWNhdGlvbnMiLAogIHZvbHVtZSAgICA9ICA1LAogIG51bWJlciAgICA9ICAzLAogIHBhZ2VzICAgICA9ICIyNTE1MjQ1OTIyMTEwOTIiLAogIG1vbnRoICAgICA9ICBqdWwsCiAgeWVhciAgICAgID0gIDIwMjIsCiAgbGFuZ3VhZ2UgID0gImVuIiwKICBpc3NuICAgICAgPSAiMjUxNS0yNDU5LCAyNTE1LTI0NjciLAogIGRvaSAgICAgICA9ICIxMC4xMTc3LzI1MTUyNDU5MjIxMTA5MjU5Igp9CgpAQVJUSUNMRXtNYWllcjIwMjMtanMsCiAgdGl0bGUgICAgPSAiUm9idXN0IEJheWVzaWFuIG1ldGEtYW5hbHlzaXM6IEFkZHJlc3NpbmcgcHVibGljYXRpb24gYmlhcyB3aXRoCiAgICAgICAgICAgICAgbW9kZWwtYXZlcmFnaW5nIiwKICBhdXRob3IgICA9ICJNYWllciwgTWF4aW1pbGlhbiBhbmQgQmFydG97XHYgc30sIEZyYW50aXtcdiBzfWVrIGFuZAogICAgICAgICAgICAgIFdhZ2VubWFrZXJzLCBFcmljLUphbiIsCiAgam91cm5hbCAgPSAiUHN5Y2hvbC4gTWV0aG9kcyIsCiAgdm9sdW1lICAgPSAgMjgsCiAgbnVtYmVyICAgPSAgMSwKICBwYWdlcyAgICA9ICIxMDctMTIyIiwKICBtb250aCAgICA9ICBmZWIsCiAgeWVhciAgICAgPSAgMjAyMywKICBsYW5ndWFnZSA9ICJlbiIsCiAgaXNzbiAgICAgPSAiMTA4Mi05ODlYLCAxOTM5LTE0NjMiLAogIHBtaWQgICAgID0gIjM1NTg4MDc1IiwKICBkb2kgICAgICA9ICIxMC4xMDM3L21ldDAwMDA0MDUiCn0KCkBNSVNDe1ZpZWNodGJhdWVyMjAyMS1vZCwKICB0aXRsZSAgICAgPSAiU2VsZWN0aW9uIG1vZGVscyBmb3IgcHVibGljYXRpb24gYmlhcyBpbiBtZXRhLWFuYWx5c2lzLgogICAgICAgICAgICAgICBQcmVzZW50YXRpb24gYXQge0VTTUFSQ29uZjIwMjF9IiwKICBhdXRob3IgICAgPSAiVmllY2h0YmF1ZXIsIFdvbGZnYW5nIiwKICBwdWJsaXNoZXIgPSAiZmlnc2hhcmUiLAogIG1vbnRoICAgICA9ICBqYW4sCiAgeWVhciAgICAgID0gIDIwMjEsCiAgZG9pICAgICAgID0gIjEwLjYwODQvTTkuRklHU0hBUkUuMTM2Mzc5MDAuVjEiCn0KCkBBUlRJQ0xFe0hlZGdlczIwMjEtb2YsCiAgdGl0bGUgICAgID0gIlRoZSBEZXNpZ24gb2YgUmVwbGljYXRpb24gU3R1ZGllcyIsCiAgYXV0aG9yICAgID0gIkhlZGdlcywgTGFycnkgViBhbmQgU2NoYXVlciwgSmFjb2IgTSIsCiAgam91cm5hbCAgID0gIkouIFIuIFN0YXQuIFNvYy4gU2VyLiBBIFN0YXQuIFNvYy4iLAogIHB1Ymxpc2hlciA9ICJPeGZvcmQgQWNhZGVtaWMiLAogIHZvbHVtZSAgICA9ICAxODQsCiAgbnVtYmVyICAgID0gIDMsCiAgcGFnZXMgICAgID0gIjg2OC04ODYiLAogIG1vbnRoICAgICA9ICBtYXIsCiAgeWVhciAgICAgID0gIDIwMjEsCiAgY29weXJpZ2h0ID0gImh0dHBzOi8vYWNhZGVtaWMub3VwLmNvbS9qb3VybmFscy9wYWdlcy9vcGVuXF9hY2Nlc3MvZnVuZGVyXF9wb2xpY2llcy9jaG9ydXMvc3RhbmRhcmRcX3B1YmxpY2F0aW9uXF9tb2RlbCIsCiAgbGFuZ3VhZ2UgID0gImVuIiwKICBpc3NuICAgICAgPSAiMDk2NC0xOTk4LCAxNDY3LTk4NVgiLAogIGRvaSAgICAgICA9ICIxMC4xMTExL3Jzc2EuMTI2ODgiCn0KCkBBUlRJQ0xFe09saXZlaXJhMjAyMy15ZiwKICB0aXRsZSAgICAgPSAiSW50ZXJuZXQtZGVsaXZlcmVkIGNvZ25pdGl2ZSBiZWhhdmlvcmFsIHRoZXJhcHkgZm9yIGFueGlldHkKICAgICAgICAgICAgICAgYW1vbmcgdW5pdmVyc2l0eSBzdHVkZW50czogQSBzeXN0ZW1hdGljIHJldmlldyBhbmQgbWV0YS1hbmFseXNpcyIsCiAgYXV0aG9yICAgID0gIk9saXZlaXJhLCBDbHtcJ2F9dWRpYSBhbmQgUGFjaGVjbywgTWFyYSBhbmQgQm9yZ2VzLCBKYW5ldGUgYW5kCiAgICAgICAgICAgICAgIE1laXJhLCBMaWxpYW5hIGFuZCBTYW50b3MsIEFuaXRhIiwKICBqb3VybmFsICAgPSAiSW50ZXJuZXQgSW50ZXJ2LiIsCiAgcHVibGlzaGVyID0gIkVsc2V2aWVyIEJWIiwKICB2b2x1bWUgICAgPSAgMzEsCiAgbnVtYmVyICAgID0gIDEwMDYwOSwKICBwYWdlcyAgICAgPSAiMTAwNjA5IiwKICBtb250aCAgICAgPSAgbWFyLAogIHllYXIgICAgICA9ICAyMDIzLAogIGNvcHlyaWdodCA9ICJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS1uYy1uZC80LjAvIiwKICBsYW5ndWFnZSAgPSAiZW4iLAogIGlzc24gICAgICA9ICIyMjE0LTc4MjkiLAogIHBtaWQgICAgICA9ICIzNjg3MzMwNyIsCiAgZG9pICAgICAgID0gIjEwLjEwMTYvai5pbnZlbnQuMjAyMy4xMDA2MDkiLAogIHBtYyAgICAgICA9ICJQTUM5OTgyNjQyIgp9CgpAQVJUSUNMRXtEZWFyMjAxOS1xYywKICB0aXRsZSAgICAgPSAiRG8gYHdhdGNoaW5nIGV5ZXMnIGluZmx1ZW5jZSBhbnRpc29jaWFsIGJlaGF2aW9yPyBBIHN5c3RlbWF0aWMKICAgICAgICAgICAgICAgcmV2aWV3IFwmIG1ldGEtYW5hbHlzaXMiLAogIGF1dGhvciAgICA9ICJEZWFyLCBLZWl0aCBhbmQgRHV0dG9uLCBLZXZpbiBhbmQgRm94LCBFbGFpbmUiLAogIGpvdXJuYWwgICA9ICJFdm9sLiBIdW0uIEJlaGF2LiIsCiAgcHVibGlzaGVyID0gIkVsc2V2aWVyIEJWIiwKICB2b2x1bWUgICAgPSAgNDAsCiAgbnVtYmVyICAgID0gIDMsCiAgcGFnZXMgICAgID0gIjI2OS0yODAiLAogIG1vbnRoICAgICA9ICBtYXksCiAgeWVhciAgICAgID0gIDIwMTksCiAgY29weXJpZ2h0ID0gImh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLW5kLzQuMC8iLAogIGxhbmd1YWdlICA9ICJlbiIsCiAgaXNzbiAgICAgID0gIjEwOTAtNTEzOCwgMTg3OS0wNjA3IiwKICBkb2kgICAgICAgPSAiMTAuMTAxNi9qLmV2b2xodW1iZWhhdi4yMDE5LjAxLjAwNiIKfQoKQEFSVElDTEV7R3VhbjIwMTYta24sCiAgdGl0bGUgICAgPSAiQSBCYXllc2lhbiBhcHByb2FjaCB0byBtaXRpZ2F0aW9uIG9mIHB1YmxpY2F0aW9uIGJpYXMiLAogIGF1dGhvciAgID0gIkd1YW4sIE1haW1lIGFuZCBWYW5kZWtlcmNraG92ZSwgSm9hY2hpbSIsCiAgam91cm5hbCAgPSAiUHN5Y2hvbi4gQnVsbC4gUmV2LiIsCiAgdm9sdW1lICAgPSAgMjMsCiAgbnVtYmVyICAgPSAgMSwKICBwYWdlcyAgICA9ICI3NC04NiIsCiAgbW9udGggICAgPSAgZmViLAogIHllYXIgICAgID0gIDIwMTYsCiAgbGFuZ3VhZ2UgPSAiZW4iLAogIGlzc24gICAgID0gIjEwNjktOTM4NCwgMTUzMS01MzIwIiwKICBwbWlkICAgICA9ICIyNjEyNjc3NiIsCiAgZG9pICAgICAgPSAiMTAuMzc1OC9zMTM0MjMtMDE1LTA4NjgtNiIKfQoKQEJPT0t7SGFycmVyMjAyMS1nbywKICB0aXRsZSAgICAgPSAiRG9pbmcgbWV0YS1hbmFseXNpcyB3aXRoIFI6IEEgaGFuZHMtb24gZ3VpZGUiLAogIGF1dGhvciAgICA9ICJIYXJyZXIsIE1hdGhpYXMgYW5kIEN1aWpwZXJzLCBQaW0gYW5kIEZ1cnVrYXdhLCBUb3NoaSBhbmQgRWJlcnQsCiAgICAgICAgICAgICAgIERhdmlkIiwKICBwdWJsaXNoZXIgPSAiQ1JDIFByZXNzIiwKICBlZGl0aW9uICAgPSAiMXN0IiwKICBtb250aCAgICAgPSAgc2VwLAogIHllYXIgICAgICA9ICAyMDIxLAogIGFkZHJlc3MgICA9ICJMb25kb24sIEVuZ2xhbmQiLAogIGxhbmd1YWdlICA9ICJlbiIsCiAgaXNibiAgICAgID0gIjk3ODAzNjc2MTAwNzQiCn0KCkBBUlRJQ0xFe0R1dmFsMjAwMC15bSwKICB0aXRsZSAgICAgPSAiVHJpbSBhbmQgZmlsbDogQSBzaW1wbGUgZnVubmVsLXBsb3QtYmFzZWQgbWV0aG9kIG9mIHRlc3RpbmcgYW5kCiAgICAgICAgICAgICAgIGFkanVzdGluZyBmb3IgcHVibGljYXRpb24gYmlhcyBpbiBtZXRhLWFuYWx5c2lzIiwKICBhdXRob3IgICAgPSAiRHV2YWwsIFMgYW5kIFR3ZWVkaWUsIFIiLAogIGpvdXJuYWwgICA9ICJCaW9tZXRyaWNzIiwKICBwdWJsaXNoZXIgPSAiV2lsZXkiLAogIHZvbHVtZSAgICA9ICA1NiwKICBudW1iZXIgICAgPSAgMiwKICBwYWdlcyAgICAgPSAiNDU1LTQ2MyIsCiAgbW9udGggICAgID0gIGp1biwKICB5ZWFyICAgICAgPSAgMjAwMCwKICBsYW5ndWFnZSAgPSAiZW4iLAogIGlzc24gICAgICA9ICIwMDA2LTM0MVgsIDE1NDEtMDQyMCIsCiAgcG1pZCAgICAgID0gIjEwODc3MzA0IiwKICBkb2kgICAgICAgPSAiMTAuMTExMS9qLjAwMDYtMzQxeC4yMDAwLjAwNDU1LngiCn0KCkBNSVNDe1ZpZWNodGJhdWVyMjAxMC14eiwKICB0aXRsZSAgID0gIkNvbmR1Y3RpbmcgbWV0YS1hbmFseXNlcyBpbiB7Un0gd2l0aCB0aGUge21ldGFmb3J9IHBhY2thZ2UiLAogIGF1dGhvciAgPSAiVmllY2h0YmF1ZXIsIFdvbGZnYW5nIiwKICBqb3VybmFsID0gIkpvdXJuYWwgb2YgU3RhdGlzdGljYWwgU29mdHdhcmUiLAogIHZvbHVtZSAgPSAgMzYsCiAgbnVtYmVyICA9ICAzLAogIHBhZ2VzICAgPSAiMS00OCIsCiAgeWVhciAgICA9ICAyMDEwLAogIGRvaSAgICAgPSAiMTAuMTg2MzcvanNzLnYwMzYuaTAzIgp9CgpATUlTQ3tCb3JlbnN0ZWluMjAwOS1tbywKICB0aXRsZSAgPSAiSW50cm9kdWN0aW9uIHRvIHtNZXRhLUFuYWx5c2lzfSIsCiAgYXV0aG9yID0gIkJvcmVuc3RlaW4sIE1pY2hhZWwgYW5kIEhlZGdlcywgTGFycnkgViBhbmQgSGlnZ2lucywgSnVsaWFuIFAgVCBhbmQKICAgICAgICAgICAgUm90aHN0ZWluLCBIYW5uYWggUiIsCiAgeWVhciAgID0gIDIwMDksCiAgZG9pICAgID0gIjEwLjEwMDIvOTc4MDQ3MDc0MzM4NiIKfQoKQEFSVElDTEV7SGlnZ2luczIwMDItZmgsCiAgdGl0bGUgICAgPSAiUXVhbnRpZnlpbmcgaGV0ZXJvZ2VuZWl0eSBpbiBhIG1ldGEtYW5hbHlzaXMiLAogIGF1dGhvciAgID0gIkhpZ2dpbnMsIEp1bGlhbiBQIFQgYW5kIFRob21wc29uLCBTaW1vbiBHIiwKICBqb3VybmFsICA9ICJTdGF0LiBNZWQuIiwKICB2b2x1bWUgICA9ICAyMSwKICBudW1iZXIgICA9ICAxMSwKICBwYWdlcyAgICA9ICIxNTM5LTE1NTgiLAogIG1vbnRoICAgID0gIGp1biwKICB5ZWFyICAgICA9ICAyMDAyLAogIGxhbmd1YWdlID0gImVuIiwKICBpc3NuICAgICA9ICIwMjc3LTY3MTUiLAogIHBtaWQgICAgID0gIjEyMTExOTE5IiwKICBkb2kgICAgICA9ICIxMC4xMDAyL3NpbS4xMTg2Igp9CgpAQVJUSUNMRXtIZWRnZXMyMDE5LXJ5LAogIHRpdGxlICAgICA9ICJTdGF0aXN0aWNhbCBhbmFseXNlcyBmb3Igc3R1ZHlpbmcgcmVwbGljYXRpb246IE1ldGEtYW5hbHl0aWMKICAgICAgICAgICAgICAgcGVyc3BlY3RpdmVzIiwKICBhdXRob3IgICAgPSAiSGVkZ2VzLCBMYXJyeSBWIGFuZCBTY2hhdWVyLCBKYWNvYiBNIiwKICBqb3VybmFsICAgPSAiUHN5Y2hvbC4gTWV0aG9kcyIsCiAgcHVibGlzaGVyID0gIkFtZXJpY2FuIFBzeWNob2xvZ2ljYWwgQXNzb2NpYXRpb24gKEFQQSkiLAogIHZvbHVtZSAgICA9ICAyNCwKICBudW1iZXIgICAgPSAgNSwKICBwYWdlcyAgICAgPSAiNTU3LTU3MCIsCiAgbW9udGggICAgID0gIG9jdCwKICB5ZWFyICAgICAgPSAgMjAxOSwKICBsYW5ndWFnZSAgPSAiZW4iLAogIGlzc24gICAgICA9ICIxMDgyLTk4OVgsIDE5MzktMTQ2MyIsCiAgcG1pZCAgICAgID0gIjMwMDcwNTQ3IiwKICBkb2kgICAgICAgPSAiMTAuMTAzNy9tZXQwMDAwMTg5Igp9Cgo="> Download .bib file</a></button></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="02-meta-analysis.html"><i class="bi bi-file-slides"></i>RevealJS (quarto-slides)</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Meta-Analysis and Multi-Lab Replication studies</h1>
<p class="subtitle lead">Replicability Crisis in Science?</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Filippo Gambarota <a href="mailto:filippo.gambarota@unipd.it" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-6666-1747" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of Padova
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">08 February 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<section id="packages" class="level3">
<h3 class="anchored" data-anchor-id="packages">Packages</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># for data manipulation</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(metafor) <span class="co"># for meta-analysis</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>() <span class="co"># load all utils functions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="meta-analysis" class="level1 section">
<h1 class="section">Meta-analysis</h1>
<section id="meta-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="meta-analysis-1">Meta-analysis</h2>
<ul>
<li><p>The meta-analysis is a statistical procedure to combine evidence from a group of studies.</p></li>
<li><p>It is usually combined with a systematic review of the literature</p></li>
<li><p>Is somehow the gold-standard approach when we want to summarise and make inference on a specific research area</p></li>
</ul>
</section>
<section id="effect-size" class="level2">
<h2 class="anchored" data-anchor-id="effect-size">Effect size</h2>
<p>To compare results from different studies, we should use a common metrics. Frequently meta-analysts use <em>standardized</em> effect sizes. For example the Pearson correlation or the Cohenâ€™s <span class="math inline">\(d\)</span>.</p>
<p><span class="math display">\[
r = \frac{\sum{(x_i - \bar{x})(y_i - \bar{y})}}{\sqrt{\sum{(x_i - \bar{x})^2}\sum{(y_i - \bar{y})^2}}}
\]</span></p>
<p><span class="math display">\[
d = \frac{\bar{x_1} - \bar{x_2}}{s_p}
\]</span></p>
<p><span class="math display">\[
s_p = \sqrt{\frac{(n_1 - 1)s_1^2 + (n_2 - 1)s_2^2}{n_1 + n_2 - 2}}
\]</span></p>
</section>
<section id="effect-size-1" class="level2">
<h2 class="anchored" data-anchor-id="effect-size-1">Effect size</h2>
<p>The advantage of standandardized effect size is that regardless the original variable, the intepretation and the scale is the same. For example the pearson correlation ranges between -1 and 1 and the Cohenâ€™s <span class="math inline">\(d\)</span> between <span class="math inline">\(- \infty\)</span> and <span class="math inline">\(\infty\)</span> and is intepreted as how many standard deviations the two groups differs.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="dv">100</span>, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>), S, <span class="at">empirical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X, <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"y"</span>, <span class="at">cex =</span> <span class="fl">1.3</span>, <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab =</span> <span class="fl">1.2</span>, <span class="at">cex.axis =</span> <span class="fl">1.2</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="fu">sprintf</span>(<span class="st">"$r = %.2f$"</span>, <span class="fu">cor</span>(X[, <span class="dv">1</span>], X[, <span class="dv">2</span>]))))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(X[, <span class="dv">2</span>] <span class="sc">~</span> X[, <span class="dv">1</span>]), <span class="at">col =</span> <span class="st">"firebrick"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(X[, <span class="dv">1</span>]), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">7</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">col =</span> <span class="st">"dodgerblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="fu">sprintf</span>(<span class="st">"$d = %.2f$"</span>, lsr<span class="sc">::</span><span class="fu">cohensD</span>(X[, <span class="dv">1</span>], X[, <span class="dv">2</span>]))),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">""</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(X[, <span class="dv">2</span>]), <span class="at">col =</span> <span class="st">"firebrick"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-6-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-effsize-se" class="level2">
<h2 class="anchored" data-anchor-id="sec-effsize-se">Effect size sampling variability</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Formula</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>For example, there are multiple methods to estimate the Cohenâ€™s <span class="math inline">\(d\)</span> sampling variability. For example:</p>
<p><span class="math display">\[
V_d = \frac{n_1 + n_2}{n_1 n_2} + \frac{d^2}{2(n_1 + n_2)}
\]</span></p>
<p>Each effect size has a specific formula for the sampling variability. The sample size is usually the most important information. Studies with high sample size have low sampling variability.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>As the sample size grows and tends to infinity, the sampling variability approach zero.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-7-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="notation" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="notation">Notation</h2>
<p>Meta-analysis notation is a little bit inconsistent in textbooks and papers. We define here some rules to simplify the work.</p>
<ul>
<li><span class="math inline">\(k\)</span> is the number of studies</li>
<li><span class="math inline">\(n_j\)</span> is the sample size of the group <span class="math inline">\(j\)</span> within a study</li>
<li><span class="math inline">\(y_i\)</span> are the observed effect size included in the meta-analysis</li>
<li><span class="math inline">\(\sigma_i^2\)</span> are the observed sampling variance of studies and <span class="math inline">\(\epsilon_i\)</span> are the sampling errors</li>
<li><span class="math inline">\(\theta\)</span> is the equal-effects parameter (see <a href="#eq-ee1" class="quarto-xref">Equation&nbsp;3</a>)</li>
<li><span class="math inline">\(\delta_i\)</span> is the random-effect (see <a href="#eq-re-mod2" class="quarto-xref">Equation&nbsp;5</a>)</li>
<li><span class="math inline">\(\mu_\theta\)</span> is the average effect of a random-effects model (see <a href="#eq-re-mod1" class="quarto-xref">Equation&nbsp;4</a>)</li>
<li><span class="math inline">\(w_i\)</span> are the meta-analysis weights (e.g., see <a href="#eq-wi" class="quarto-xref">Equation&nbsp;1</a>)</li>
<li><span class="math inline">\(\tau^2\)</span> is the heterogeneity (see <a href="#eq-re-mod2" class="quarto-xref">Equation&nbsp;5</a>)</li>
<li><span class="math inline">\(\Delta\)</span> is the (generic) population effect size</li>
<li><span class="math inline">\(s_j^2\)</span> is the variance of the group <span class="math inline">\(j\)</span> within a study</li>
</ul>
</section>
<section id="extra---simulating-meta-analysis" class="level2 extra">
<h2 class="extra anchored" data-anchor-id="extra---simulating-meta-analysis">Extra - Simulating Meta-Analysis</h2>
<p>For the examples and plots Iâ€™m going to use simulated data<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. We simulate <em>unstandardized</em> effect sizes (UMD) because the computations are easier and the estimator is unbiased <span class="citation" data-cites="Viechtbauer2005-zt">(e.g., <a href="#ref-Viechtbauer2005-zt" role="doc-biblioref">Viechtbauer 2005</a>)</span></p>
<p>More specifically we simulate hypothetical studies where two independent groups are compared:</p>
<p><span class="math display">\[
\Delta = \overline{X_1} - \overline{X_2}
\]</span></p>
<p><span class="math display">\[
SE_{\Delta} = \sqrt{\frac{s^2_1}{n_1} + \frac{s^2_2}{n_2}}
\]</span></p>
<p>With <span class="math inline">\(X_{1_i} \sim \mathcal{N}(0, 1)\)</span> and <span class="math inline">\(X_{2_i} \sim \mathcal{N}(\Delta, 1)\)</span></p>
<p>The main advantage is that, compared to standardized effect size, the sampling variability do not depends on the effect size itself, simplifying the computations.</p>
</section>
<section id="meta-analysis-as-a-weighted-average" class="level2">
<h2 class="anchored" data-anchor-id="meta-analysis-as-a-weighted-average">Meta-analysis as a (weighted) average</h2>
<p>Letâ€™s imagine to have <span class="math inline">\(k = 10\)</span> studies. The segments are the 95% confidence intervals.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ni <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">runif</span>(k, <span class="dv">10</span>, <span class="dv">100</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">sim_studies</span>(k, <span class="fl">0.5</span>, <span class="dv">0</span>, ni, ni)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>qf <span class="ot">&lt;-</span> <span class="fu">quick_forest</span>(dat)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>qf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-8-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>What could you say about the phenomenon?</p>
</section>
<section id="meta-analysis-as-a-weighted-average-1" class="level2">
<h2 class="anchored" data-anchor-id="meta-analysis-as-a-weighted-average-1">Meta-analysis as a (weighted) average</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Formula</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>We could say that the average effect is roughly ~0.5 and there is some variability around the average.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>avg <span class="ot">&lt;-</span> <span class="fu">mean</span>(dat<span class="sc">$</span>yi)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>qf <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> avg, <span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> yi, <span class="at">y =</span> id<span class="fl">-0.3</span>, <span class="at">xend =</span> avg, <span class="at">yend =</span> id<span class="fl">-0.3</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="at">color =</span> <span class="st">"firebrick"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-9-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p><span class="math display">\[
\overline y = \frac{\sum_{i = 1}^k y_i}{k}
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ybar <span class="ot">&lt;-</span> <span class="fu">mean</span>(dat<span class="sc">$</span>yi)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>ybar</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.5649149</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="meta-analysis-as-a-weighted-average-2" class="level2">
<h2 class="anchored" data-anchor-id="meta-analysis-as-a-weighted-average-2">Meta-analysis as a (weighted) average</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Equation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>The simple average is a good statistics. But some studies are clearly more precise (narrower confidence intervals) than others i.e.&nbsp;the sampling variance is lower.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-11-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>We can compute a weighted average where each study is weighted (<span class="math inline">\(w_i\)</span>) by the inverse of the variance. This is called <em>inverse-variance weighting</em>. Clearly, a weighted average were all weights are the same reduced to a simple unweighted average.</p>
<p><span class="math display">\[
\overline y = \frac{\sum_{i = 1}^k y_iw_i}{\sum_{i = 1}^k w_i}
\]</span> <span id="eq-wi"><span class="math display">\[
w_i = \frac{1}{v_i}
\tag{1}\]</span></span></p>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>wi <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>dat<span class="sc">$</span>vi</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>ywbar <span class="ot">&lt;-</span> <span class="fu">weighted.mean</span>(dat<span class="sc">$</span>yi, wi) </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>ywbar</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.5584582</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The value is (not so) different compared to the unweighted version (0.5649149). They are not exactly the same but given that weights are pretty homogeneous the two estimate are similar.</p>
</div>
</div>
</div>
</section>
<section id="meta-analysis-as-a-weighted-average-3" class="level2">
<h2 class="anchored" data-anchor-id="meta-analysis-as-a-weighted-average-3">Meta-analysis as a (weighted) average</h2>
<p>What we did is a very simple model but actually is a meta-analysis model. This is commonly known as <strong>equal-effects model</strong> (or fixed-effect) <strong>model</strong>.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quick_forest</span>(dat, <span class="at">weigth =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ywbar, <span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Weighted Average"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-13-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-ee" class="level2">
<h2 class="anchored" data-anchor-id="sec-ee">Equal-effects model (EE)</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Assumptions</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Equations</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Plots</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>The EE model is the simplest meta-analysis model. The assumptions are:</p>
<ul>
<li>there is a unique, true effect size to estimate <span class="math inline">\(\theta\)</span></li>
<li>each study is a more or less precise estimate of <span class="math inline">\(\theta\)</span></li>
<li>there is no TRUE variability among studies. The observed variability is due to studies that are imprecise (i.e., sampling error)
<ul>
<li>assuming that each study has a very large sample size, the observed variability is close to zero.</li>
</ul></li>
</ul>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>Formally, we can define the EE model as: <span id="eq-ee1"><span class="math display">\[
y_i = \theta + \epsilon_i
\tag{2}\]</span></span></p>
<p><span id="eq-ee1"><span class="math display">\[
\epsilon_i \sim \mathcal{N}(0, \sigma^2_i)
\tag{3}\]</span></span></p>
<p>Where <span class="math inline">\(\sigma^2_i\)</span> is the vector of sampling variabilities of <span class="math inline">\(k\)</span> studies. This is a standard linear model but with heterogeneous sampling variances.</p>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">

</div>
</div>
</div>
</section>
<section id="sec-ee-high-low" class="level2">
<h2 class="anchored" data-anchor-id="sec-ee-high-low">Equal-effects model (EE)</h2>
<p>A crucial part of the EE model is that, assuming studies with very large sample sizes, <span class="math inline">\(\epsilon_i\)</span> will tend to 0 and each study is an almost perfect estimation of <span class="math inline">\(\theta\)</span>. Letâ€™s simulate two models, with <span class="math inline">\(k = 10\)</span> studies and <span class="math inline">\(n = 30\)</span> and <span class="math inline">\(n = 500\)</span>. The effect size is the same <span class="math inline">\(0.5\)</span>.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>dat_low  <span class="ot">&lt;-</span> <span class="fu">sim_studies</span>(<span class="dv">10</span>, <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">30</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>dat_high <span class="ot">&lt;-</span> <span class="fu">sim_studies</span>(<span class="dv">10</span>, <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">500</span>, <span class="dv">500</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>qf_low <span class="ot">&lt;-</span> <span class="fu">quick_forest</span>(dat_low) <span class="sc">+</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$n_{1,2} = 30$"</span>))</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>qf_high <span class="ot">&lt;-</span> <span class="fu">quick_forest</span>(dat_high) <span class="sc">+</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$n_{1,2} = 500$"</span>))</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>plt_high_low <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  qf_low,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  qf_high</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>plt_high_low</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-15-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="equal-effects-model-ee" class="level2">
<h2 class="anchored" data-anchor-id="equal-effects-model-ee">Equal-effects model (EE)</h2>
<p>Clearly, as <span class="math inline">\(n\)</span> increase, each study is essentially a perfect estimation of <span class="math inline">\(\theta\)</span> as depicted in the theoretical figure (see slide <a href="#sec-ee" class="quarto-xref">1.11</a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-16-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="are-the-ee-assumptions-realistic" class="level1 question">
<h1 class="question">Are the EE assumptions realistic?</h1>
<section id="are-the-ee-assumptions-realistic-1" class="level2">
<h2 class="anchored" data-anchor-id="are-the-ee-assumptions-realistic-1">Are the EE assumptions realistic?</h2>
<p>The EE model is appropriate if our studies are somehow exact replications of the exact same effect. We are assuming that there is no real variability.</p>
<p>. . .</p>
<p>However, meta-analysis rarely report the results of <span class="math inline">\(k\)</span> exact replicates. It is more common to include studies with the same <strong>underlying</strong> objective but a roughly similar method.</p>
<ul>
<li>people with different ages or other participant-level differences</li>
<li>different methodology</li>
<li>â€¦</li>
</ul>
</section>
<section id="are-the-ee-assumptions-realistic-2" class="level2">
<h2 class="anchored" data-anchor-id="are-the-ee-assumptions-realistic-2">Are the EE assumptions realistic?</h2>
<p>In this case, even with extremely large studies, our effect could be larger in some conditions or smaller or absent in other conditions.</p>
<p>In other terms we are assuming that there could be some variability (i.e., <strong>heterogeneity</strong>) among studies that is independent from the sample size (or more generally the precision)</p>
</section>
<section id="random-effects-model-re" class="level2">
<h2 class="anchored" data-anchor-id="random-effects-model-re">Random-effects model (RE)</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Theory</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Estimation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Plots</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>We can extend the EE model including another source of variability, <span class="math inline">\(\tau^2\)</span>. <span class="math inline">\(\tau^2\)</span> is the true heterogeneity among studies caused by methdological differences or intrisic variability in the phenomenon.</p>
<p>Formally we can extend the equation <a href="#eq-ee1" class="quarto-xref">3</a> as: <span id="eq-re-mod1"><span class="math display">\[
y_i = \mu_{\theta} + \delta_i + \epsilon_i
\tag{4}\]</span></span></p>
<p><span id="eq-re-mod2"><span class="math display">\[
\delta_i \sim \mathcal{N}(0, \tau^2)
\tag{5}\]</span></span></p>
<p><span class="math display">\[
\epsilon_i \sim \mathcal{N}(0, \sigma^2_i)
\]</span></p>
<p>Where <span class="math inline">\(\mu_{\theta}\)</span> is the average effect size and <span class="math inline">\(\delta_i\)</span> is the study-specific deviation from the average effect (regulated by <span class="math inline">\(\tau^2\)</span>).</p>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>Given that we extended the EE model equation. Also the estimation of the average effect need to be extended. Basically the RE is still a weighted average but weights need to include also <span class="math inline">\(\tau^2\)</span>.</p>
<p><span id="eq-re1"><span class="math display">\[
\overline y = \frac{\sum_{i = 1}^k y_iw^*_i}{\sum_{i = 1}^k w^*_i}
\tag{6}\]</span></span></p>
<p><span id="eq-re2"><span class="math display">\[
w^*_i = \frac{1}{v_i + \tau^2}
\tag{7}\]</span></span></p>
<p>The consequence is that weights are different where extremely precise/imprecise studies will impact less the estimation of the average effect under the RE model compared to EE.</p>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">

</div>
</div>
</div>
</section>
<section id="random-effects-model" class="level2">
<h2 class="anchored" data-anchor-id="random-effects-model">Random-effects model</h2>
<p>The crucial difference with the EE model is that even with large <span class="math inline">\(n\)</span>, only the <span class="math inline">\(\mu_{\theta} + \delta_i\)</span> are estimated (almost) without error. As long <span class="math inline">\(\tau^2 \neq 0\)</span> there will be variability in the effect sizes.</p>
</section>
<section id="random-effects-model-1" class="level2">
<h2 class="anchored" data-anchor-id="random-effects-model-1">Random-effects model</h2>
<p>Again, we can easily demonstrate this with a simulation. We use the same simulation as slide <a href="#sec-ee-high-low" class="quarto-xref">1.12</a> but including <span class="math inline">\(\tau^2 = 0.2\)</span>.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>dat_low  <span class="ot">&lt;-</span> <span class="fu">sim_studies</span>(<span class="dv">10</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="dv">30</span>, <span class="dv">30</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>dat_high <span class="ot">&lt;-</span> <span class="fu">sim_studies</span>(<span class="dv">10</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="dv">500</span>, <span class="dv">500</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>qf_low <span class="ot">&lt;-</span> <span class="fu">quick_forest</span>(dat_low) <span class="sc">+</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$n_{1,2} = 30$"</span>))</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>qf_high <span class="ot">&lt;-</span> <span class="fu">quick_forest</span>(dat_high) <span class="sc">+</span> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$n_{1,2} = 500$"</span>))</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>qf_tau_high_low <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  qf_low,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  qf_high</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>qf_tau_high_low</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-19-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>The main point is that even with <span class="math inline">\(n \to \infty\)</span> the observed variance is not reduced as long <span class="math inline">\(\tau^2 \neq 0\)</span>.</p>
</section>
<section id="extra---simulating-meta-analysis-1" class="level2 extra">
<h2 class="extra anchored" data-anchor-id="extra---simulating-meta-analysis-1">Extra - Simulating Meta-Analysis</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Equations 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Equations 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>For the simulations, we can generate data from effect size and variance sampling distributions<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. The <em>unstandardized</em> effect size is a mean difference between independent groups. The sampling distribution is:</p>
<p><span class="math display">\[
y_i \sim \mathcal{N}(\Delta, \frac{1}{n_1} + \frac{1}{n_2})
\]</span></p>
<p>Where <span class="math inline">\(\Delta\)</span> is the population level effect size and <span class="math inline">\(n_{1,2}\)</span> are the sample sizes of the two studies. The sampling variances are generated from a <span class="math inline">\(\chi^2\)</span> distribution:</p>
<p><span class="math display">\[
\sigma_i^2 \sim \frac{\chi^2_{n_1 + n_2 - 2}}{n_1 + n_2 - 2} (\frac{1}{n_1} + \frac{1}{n_2})
\]</span></p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>Clearly we can include <span class="math inline">\(\tau^2\)</span> to include between-study variability. For an equal-effects model <span class="math inline">\(\Delta = \theta\)</span> thus the equation is unchanged. For a random-effects model, <span class="math inline">\(\Delta = \theta_i = \mu_\theta + \delta_i\)</span></p>
<p><span class="math display">\[
y_i \sim \mathcal{N}(\Delta, \tau^2 + \frac{1}{n_1} + \frac{1}{n_2})
\]</span></p>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<p>The simulation is implemented in the <code>sim_studies</code> function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sim_studies <span class="ot">&lt;-</span> <span class="cf">function</span>(k, theta, tau2, n0, n1, <span class="at">summary =</span> <span class="cn">FALSE</span>){</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  yi <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(k, theta, <span class="fu">sqrt</span>(tau2 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n0 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n1))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  vi <span class="ot">&lt;-</span> (<span class="fu">rchisq</span>(k, n0 <span class="sc">+</span> n1 <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">/</span> (n0 <span class="sc">+</span> n1 <span class="sc">-</span> <span class="dv">2</span>)) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>n0 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n1)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(yi, vi, <span class="at">sei =</span> <span class="fu">sqrt</span>(vi))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(summary){</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">summary_es</span>(out)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">sim_studies</span>(<span class="at">k =</span> <span class="dv">10</span>, <span class="at">theta =</span> <span class="fl">0.5</span>, <span class="at">tau2 =</span> <span class="fl">0.2</span>, <span class="at">n0 =</span> <span class="dv">30</span>, <span class="at">n1 =</span> <span class="dv">30</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>dat</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              yi         vi       sei</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   0.239972521 0.05110677 0.2260681</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   0.060595945 0.05598818 0.2366182</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   0.601009753 0.05284917 0.2298895</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  -0.433374153 0.07347979 0.2710715</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   1.060998657 0.08297724 0.2880577</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  -0.009347895 0.08819882 0.2969829</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  -0.303309080 0.05344227 0.2311758</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8   0.965465867 0.06425877 0.2534931</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9   1.303637758 0.05931308 0.2435428</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  1.218931846 0.08062556 0.2839464</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="heterogeneity" class="level2">
<h2 class="anchored" data-anchor-id="heterogeneity">Heterogeneity</h2>
<p>We discussed so far about estimating the average effect (<span class="math inline">\(\theta\)</span> or <span class="math inline">\(\mu_\theta\)</span>). But how to estimate the heterogeneity?</p>
<p>There are several estimators for <span class="math inline">\(\tau^2\)</span></p>
<ul>
<li>Hunterâ€“Schmidt</li>
<li>Hedges</li>
<li>DerSimonianâ€“Laird</li>
<li>Maximum-Likelihood</li>
<li>Restricted Maximum-Likelihood (REML)</li>
</ul>
<p>We will mainly use the REML estimator. See <span class="citation" data-cites="Viechtbauer2005-zt">Viechtbauer (<a href="#ref-Viechtbauer2005-zt" role="doc-biblioref">2005</a>)</span> and <span class="citation" data-cites="Veroniki2016-zs">(<a href="#ref-Veroniki2016-zs" role="doc-biblioref"><strong>Veroniki2016-zs?</strong></a>)</span> for more details.</p>
</section>
<section id="the-q-statistics" class="level2">
<h2 class="anchored" data-anchor-id="the-q-statistics">The Q Statistics<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></h2>
<p>The Q statistics is used to make statistical inference on the heterogeneity. Can be considered as a weighted sum of squares:</p>
<p><span class="math display">\[
Q = \sum^k_{i = 1}w_i(y_i - \hat \mu)^2
\]</span></p>
<p>Where <span class="math inline">\(\hat \mu\)</span> is EE estimation (regardless if <span class="math inline">\(\tau^2 \neq 0\)</span>) and <span class="math inline">\(w_i\)</span> are the inverse-variance weights. Note that in the case of <span class="math inline">\(w_1 = w_2 ... = w_i\)</span>, Q is just a standard sum of squares (or deviance).</p>
</section>
<section id="the-q-statistics-1" class="level2">
<h2 class="anchored" data-anchor-id="the-q-statistics-1">The Q Statistics</h2>
<ul>
<li><p>Given that we are summing up squared distances, they should be approximately <span class="math inline">\(\chi^2\)</span> with <span class="math inline">\(df = k - 1\)</span>. In case of no heterogeneity (<span class="math inline">\(\tau^2 = 0\)</span>) the observed variability is caused by sampling error only. The expectd value of the <span class="math inline">\(\chi^2\)</span> is just the degrees of freedom (<span class="math inline">\(df = k - 1\)</span>).</p></li>
<li><p>In case of <span class="math inline">\(\tau^2 \neq 0\)</span>, the expected value is <span class="math inline">\(k - 1 + \lambda\)</span> where <span class="math inline">\(\lambda\)</span> is a non-centrality parameter.</p></li>
<li><p>In other terms, if the expected value of <span class="math inline">\(Q\)</span> exceed the expected value assuming no heterogeneity, we have evidence that <span class="math inline">\(\tau^2 \neq 0\)</span>.</p></li>
</ul>
</section>
<section id="the-q-statistics-2" class="level2">
<h2 class="anchored" data-anchor-id="the-q-statistics-2">The Q Statistics</h2>
<p>Letâ€™s try a more practical approach. We simulate a lot of meta-analysis with and without heterogeneity and we check the Q statistics.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>get_Q <span class="ot">&lt;-</span> <span class="cf">function</span>(yi, vi){</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  wi <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>vi</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  theta_ee <span class="ot">&lt;-</span> <span class="fu">weighted.mean</span>(yi, wi)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(wi<span class="sc">*</span>(yi <span class="sc">-</span> theta_ee)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>tau2 <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>Qs_tau2_0 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, nsim)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>Qs_tau2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, nsim)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>res2_tau2_0 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, nsim)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>res2_tau2 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, nsim)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim){</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  dat_tau2_0 <span class="ot">&lt;-</span> <span class="fu">sim_studies</span>(<span class="at">k =</span> <span class="dv">30</span>, <span class="at">theta =</span> <span class="fl">0.5</span>, <span class="at">tau2 =</span> <span class="dv">0</span>, <span class="at">n0 =</span> n, <span class="at">n1 =</span> n)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  dat_tau2 <span class="ot">&lt;-</span> <span class="fu">sim_studies</span>(<span class="at">k =</span> <span class="dv">30</span>, <span class="at">theta =</span> <span class="fl">0.5</span>, <span class="at">tau2 =</span> tau2, <span class="at">n0 =</span> n, <span class="at">n1 =</span> n)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  theta_ee_tau2_0 <span class="ot">&lt;-</span> <span class="fu">weighted.mean</span>(dat_tau2_0<span class="sc">$</span>yi, <span class="dv">1</span><span class="sc">/</span>dat_tau2_0<span class="sc">$</span>vi)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  theta_ee <span class="ot">&lt;-</span> <span class="fu">weighted.mean</span>(dat_tau2<span class="sc">$</span>yi, <span class="dv">1</span><span class="sc">/</span>dat_tau2<span class="sc">$</span>vi)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  res2_tau2_0[[i]] <span class="ot">&lt;-</span> dat_tau2_0<span class="sc">$</span>yi <span class="sc">-</span> theta_ee_tau2_0</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  res2_tau2[[i]] <span class="ot">&lt;-</span> dat_tau2<span class="sc">$</span>yi <span class="sc">-</span> theta_ee</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  Qs_tau2_0[i] <span class="ot">&lt;-</span> <span class="fu">get_Q</span>(dat_tau2_0<span class="sc">$</span>yi, dat_tau2_0<span class="sc">$</span>vi)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  Qs_tau2[i] <span class="ot">&lt;-</span> <span class="fu">get_Q</span>(dat_tau2<span class="sc">$</span>yi, dat_tau2<span class="sc">$</span>vi)</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> k <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Qs_tau2_0, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.08</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">150</span>),</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Q"</span>,</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">tau^2 = 0$"</span>))</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dchisq</span>(x, df), <span class="dv">0</span>, <span class="dv">100</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"firebrick"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">unlist</span>(res2_tau2_0), <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">tau^2 = 0$"</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$y_i - </span><span class="sc">\\</span><span class="st">hat{</span><span class="sc">\\</span><span class="st">mu}$"</span>))</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>n <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n)), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"dodgerblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Qs_tau2, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.08</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">150</span>),</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Q"</span>,</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">tau^2 = 0.1$"</span>))</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dchisq</span>(x, df), <span class="dv">0</span>, <span class="dv">100</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"firebrick"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">unlist</span>(res2_tau2), <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">tau^2 = 0.1$"</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$y_i - </span><span class="sc">\\</span><span class="st">hat{</span><span class="sc">\\</span><span class="st">mu}$"</span>))</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>n <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n)), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"dodgerblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-22-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-q-statistics-3" class="level2">
<h2 class="anchored" data-anchor-id="the-q-statistics-3">The Q Statistics</h2>
<p>Letâ€™s try a more practical approach. We simulate a lot of meta-analysis with and without heterogeneity and we check the Q statistics.</p>
<p>. . .</p>
<ul>
<li>clearly, in the presence of heterogeneity, the expected value of the Q statistics is higher (due to <span class="math inline">\(\lambda\)</span>) and also residuals are larger.</li>
</ul>
<p>. . .</p>
<ul>
<li>we can calculate a p-value for deviation from the <span class="math inline">\(\tau^2 = 0\)</span> case as evidence agaist the absence of heterogeneity</li>
</ul>
</section>
<section id="estimating-tau2" class="level2">
<h2 class="anchored" data-anchor-id="estimating-tau2">Estimating <span class="math inline">\(\tau^2\)</span></h2>
<p>The Q statistics is rarely used to directly represent the heterogeneity. The raw measure of heterogeneity is <span class="math inline">\(\tau^2\)</span>. The REML (restricted maximum likelihood) estimator is often used.</p>
<p><span class="math display">\[
\hat \tau^2 = \frac{\sum_{i = 1}^k w_i^2[(y_i - \hat \mu)^2 - \sigma^2_i]}{\sum_{i = 1}^k w_i^2} + \frac{1}{\sum_{i = 1}^k w_i}
\]</span></p>
<p>Where <span class="math inline">\(\hat{\mu}\)</span> is the weighted average (i.e., maximum likelihood estimation, see <a href="#eq-re1" class="quarto-xref">Equation&nbsp;6</a> and <a href="#eq-re2" class="quarto-xref">Equation&nbsp;7</a>).</p>
</section>
<section id="tau2-as-heterogeneity-measure" class="level2">
<h2 class="anchored" data-anchor-id="tau2-as-heterogeneity-measure"><span class="math inline">\(\tau^2\)</span> as heterogeneity measure</h2>
<ul>
<li><span class="math inline">\(\tau^2\)</span> is the direct measure of heterogeneity in meta-analysis</li>
<li>it is intepreted as a standard deviation (or variance) of the distribution of true effects</li>
<li>a phenomenon associated with an higher <span class="math inline">\(\tau^2\)</span> is interpred as more variable</li>
</ul>
</section>
<section id="tau2-as-heterogeneity-measure-1" class="level2">
<h2 class="anchored" data-anchor-id="tau2-as-heterogeneity-measure-1"><span class="math inline">\(\tau^2\)</span> as heterogeneity measure</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we generate 1e5 values from a random-effect model with certain parameters and different tau2 values</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and check the expected distrubution of effect sizes</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>tau2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>dats <span class="ot">&lt;-</span> <span class="fu">lapply</span>(tau2, <span class="cf">function</span>(x) <span class="fu">sim_studies</span>(k, <span class="fl">0.5</span>, x, n, n))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dats) <span class="ot">&lt;-</span> tau2</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(dats, <span class="at">.id =</span> <span class="st">"tau2"</span>) </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>tau2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat<span class="sc">$</span>tau2)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>tau2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat<span class="sc">$</span>tau2, <span class="at">labels =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="fu">sprintf</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">tau^2 = %s$"</span>, <span class="fu">levels</span>(dat<span class="sc">$</span>tau2))))</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> yi, <span class="at">y =</span> <span class="fu">after_stat</span>(density))) <span class="sc">+</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>, <span class="at">lwd =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>tau2, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"Expected $y_i$ distribution, $d = 0.5$, $n_{1,2} = 100$"</span>)) <span class="sc">+</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$y_i$"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-23-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="i2-higgins2002-fh" class="level2">
<h2 class="anchored" data-anchor-id="i2-higgins2002-fh"><span class="math inline">\(I^2\)</span> <span class="citation" data-cites="Higgins2002-fh">(<a href="#ref-Higgins2002-fh" role="doc-biblioref">Higgins and Thompson 2002</a>)</span></h2>
<p>We have two sources of variability in a random-effects meta-analysis, the sampling variabilities <span class="math inline">\(\sigma_i^2\)</span> and <span class="math inline">\(\tau^2\)</span>. We can use the <span class="math inline">\(I^2\)</span> to express the interplay between the two. <span id="eq-i2"><span class="math display">\[
I^2 = 100\% \times \frac{\hat{\tau}^2}{\hat{\tau}^2 + \tilde{v}}
\tag{8}\]</span></span></p>
<p><span class="math display">\[
\tilde{v} = \frac{(k-1) \sum w_i}{(\sum w_i)^2 - \sum w_i^2},
\]</span></p>
<p>Where <span class="math inline">\(\tilde{v}\)</span> is the typical sampling variability. <span class="math inline">\(I^2\)</span> is intepreted as the proportion of total variability due to real heterogeneity (i.e., <span class="math inline">\(\tau^2\)</span>)</p>
</section>
<section id="i2-higgins2002-fh-1" class="level2">
<h2 class="anchored" data-anchor-id="i2-higgins2002-fh-1"><span class="math inline">\(I^2\)</span> <span class="citation" data-cites="Higgins2002-fh">(<a href="#ref-Higgins2002-fh" role="doc-biblioref">Higgins and Thompson 2002</a>)</span><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></h2>
<p>Note that we can have the same <span class="math inline">\(I^2\)</span> in two completely different meta-analysis. An high <span class="math inline">\(I^2\)</span> does not represent high heterogeneity. Letâ€™s assume to have two meta-analysis with <span class="math inline">\(k\)</span> studies and small (<span class="math inline">\(n = 30\)</span>) vs large (<span class="math inline">\(n = 500\)</span>) sample sizes.</p>
<p>Letâ€™s solve <a href="#eq-i2" class="quarto-xref">Equation&nbsp;8</a> for <span class="math inline">\(\tau^2\)</span> (using <code>filor::tau2_from_I2()</code>) and we found that the same <span class="math inline">\(I^2\)</span> can be obtained with two completely different <span class="math inline">\(\tau^2\)</span> values:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>n_1 <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>vi_1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n_1 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n_1</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>tau2_1 <span class="ot">&lt;-</span> filor<span class="sc">::</span><span class="fu">tau2_from_I2</span>(<span class="fl">0.8</span>, vi_1)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>tau2_1</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.2666667</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>n_2 <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>vi_2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n_2 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n_2</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>tau2_2 <span class="ot">&lt;-</span> filor<span class="sc">::</span><span class="fu">tau2_from_I2</span>(<span class="fl">0.8</span>, vi_2)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>tau2_2</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.016</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="i2-higgins2002-fh-2" class="level2">
<h2 class="anchored" data-anchor-id="i2-higgins2002-fh-2"><span class="math inline">\(I^2\)</span> <span class="citation" data-cites="Higgins2002-fh">(<a href="#ref-Higgins2002-fh" role="doc-biblioref">Higgins and Thompson 2002</a>)</span></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>n_1 <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>vi_1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n_1 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n_1</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>tau2_1 <span class="ot">&lt;-</span> filor<span class="sc">::</span><span class="fu">tau2_from_I2</span>(<span class="fl">0.8</span>, vi_1)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>tau2_1</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.2666667</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>n_2 <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>vi_2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n_2 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n_2</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>tau2_2 <span class="ot">&lt;-</span> filor<span class="sc">::</span><span class="fu">tau2_from_I2</span>(<span class="fl">0.8</span>, vi_2)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>tau2_2</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.016</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>. . .</p>
<p>In other terms, the <span class="math inline">\(I^2\)</span> can be considered a good index of heterogeneity only when the total variance (<span class="math inline">\(\tilde{v} + \tau^2\)</span>) is the same.</p>
</section>
</section>
<section id="meta-analysis-in-r" class="level1 section">
<h1 class="section">Meta-analysis in R</h1>
<section id="meta-analysis-in-r-1" class="level2">
<h2 class="anchored" data-anchor-id="meta-analysis-in-r-1">Meta-analysis in R</h2>
<p>In R there are several packages to conduct a meta-analysis. For me, the best package is <code>metafor</code> <span class="citation" data-cites="Viechtbauer2010-xz">(<a href="#ref-Viechtbauer2010-xz" role="doc-biblioref">Viechtbauer 2010</a>)</span>. The package support all steps in meta-analysis providing also an amazing documentation:</p>
<div class="cell" data-layout-align="center">
<iframe src="https://www.metafor-project.org/doku.php/metafor" width="960" height="400px" data-external="1">
</iframe>
</div>
</section>
<section id="equal-effects-model-in-r" class="level2">
<h2 class="anchored" data-anchor-id="equal-effects-model-in-r">Equal-effects model in R</h2>
<p>Disclaimer: we are omitting the important part of collecting the information from published studies and calculating the (un)standardized effect sizes. Clerly this part is highly dependent on the actual dataset.</p>
<p>There are few useful resources:</p>
<ul>
<li>Chapters 1-9 from Borestein et al. <span class="citation" data-cites="Borenstein2009-mo">(<a href="#ref-Borenstein2009-mo" role="doc-biblioref">2009</a>)</span></li>
<li>The <code>metafor::escalc()</code> <a href="https://wviechtb.github.io/metafor/reference/escalc.html">function</a> that calculate all effects size and report an useful documentation</li>
</ul>
</section>
<section id="equal-effects-model-in-r-1" class="level2">
<h2 class="anchored" data-anchor-id="equal-effects-model-in-r-1">Equal-effects model in R</h2>
<p>We can simulate an EE dataset (i.e., <span class="math inline">\(\tau^2 = 0\)</span>) and then fit the model with <code>metafor</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">30</span> <span class="co"># number of studies</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">runif</span>(k, <span class="dv">10</span>, <span class="dv">60</span>)) <span class="co"># random sample sizes with a plausible range</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">sim_studies</span>(<span class="at">k =</span> k, <span class="at">theta =</span> theta, <span class="at">tau2 =</span> <span class="dv">0</span>, <span class="at">n0 =</span> n, <span class="at">n1 =</span> n)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>n <span class="ot">&lt;-</span> n <span class="co"># n1 and n2 are the same, put only one</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            yi         vi       sei  n</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 0.805614130 0.08263361 0.2874606 32</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 0.260807459 0.04749784 0.2179400 47</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 0.675372623 0.06075145 0.2464781 38</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 0.009179529 0.05057025 0.2248783 29</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 0.446279600 0.09250380 0.3041444 22</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 0.343721214 0.12479153 0.3532584 18</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="equal-effects-model-in-r-2" class="level2">
<h2 class="anchored" data-anchor-id="equal-effects-model-in-r-2">Equal-effects model in R</h2>
<p>We can start by some summary statistics:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unweighted summary statistics for the effect</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat<span class="sc">$</span>yi)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -0.2561  0.2013  0.3380  0.3123  0.4370  0.8056</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># unweighted summary statistics for the variances</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat<span class="sc">$</span>vi)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.03474 0.04835 0.07266 0.08351 0.10501 0.23412</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co"># sample sizes</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat<span class="sc">$</span>n) <span class="co"># n0 and n1 are the same</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   10.00   17.25   31.00   31.40   46.75   55.00</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="equal-effects-model-in-r-3" class="level2">
<h2 class="anchored" data-anchor-id="equal-effects-model-in-r-3">Equal-effects model in R</h2>
<p>Then we can use the <code>metafor::rma.uni()</code> function (or more simply <code>metafor::rma()</code>) providing the effect size, variances and <code>method = "EE"</code> to specify that we are fitting an equal-effects model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fit_ee <span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">method =</span> <span class="st">"EE"</span>, <span class="at">data =</span> dat)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_ee)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Equal-Effects Model (k = 30)</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   logLik  deviance       AIC       BIC      AICc   </span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   1.3303   20.4782   -0.6605    0.7407   -0.5177   </span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I^2 (total heterogeneity / total variability):   0.00%</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H^2 (total variability / sampling variability):  0.71</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test for Heterogeneity:</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Q(df = 29) = 20.4782, p-val = 0.8774</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Results:</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimate      se    zval    pval   ci.lb   ci.ub      </span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0.3338  0.0469  7.1211  &lt;.0001  0.2420  0.4257  *** </span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="equal-effects-model-in-r-4" class="level2">
<h2 class="anchored" data-anchor-id="equal-effects-model-in-r-4">Equal-effects model in R</h2>
<p>We can easily show that the results is the same as performing a simple weighted average using study-specific variances as weight:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>wi <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>dat<span class="sc">$</span>vi</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">weighted.mean</span>(dat<span class="sc">$</span>yi, wi)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.3338458</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_ee)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Equal-Effects Model (k = 30)</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   logLik  deviance       AIC       BIC      AICc   </span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   1.3303   20.4782   -0.6605    0.7407   -0.5177   </span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I^2 (total heterogeneity / total variability):   0.00%</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H^2 (total variability / sampling variability):  0.71</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test for Heterogeneity:</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Q(df = 29) = 20.4782, p-val = 0.8774</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Results:</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimate      se    zval    pval   ci.lb   ci.ub      </span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0.3338  0.0469  7.1211  &lt;.0001  0.2420  0.4257  *** </span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="random-effects-model-in-r" class="level2">
<h2 class="anchored" data-anchor-id="random-effects-model-in-r">Random-effects model in R</h2>
<p>The syntax for a random-effects model is the same, we just need to use <code>method = "REML"</code> (or another <span class="math inline">\(\tau^2\)</span> estimation method)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fit_re <span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">method =</span> <span class="st">"REML"</span>, <span class="at">data =</span> dat)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_re)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Random-Effects Model (k = 30; tau^2 estimator: REML)</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   logLik  deviance       AIC       BIC      AICc   </span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0.8897   -1.7793    2.2207    4.9553    2.6822   </span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tau^2 (estimated amount of total heterogeneity): 0 (SE = 0.0160)</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tau (square root of estimated tau^2 value):      0</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I^2 (total heterogeneity / total variability):   0.00%</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H^2 (total variability / sampling variability):  1.00</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test for Heterogeneity:</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Q(df = 29) = 20.4782, p-val = 0.8774</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Results:</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimate      se    zval    pval   ci.lb   ci.ub      </span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0.3338  0.0469  7.1211  &lt;.0001  0.2420  0.4257  *** </span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="random-effects-model-in-r-1" class="level2">
<h2 class="anchored" data-anchor-id="random-effects-model-in-r-1">Random-effects model in R</h2>
<p>We can easily compare the models using the <code>compare_rma()</code> function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>filor<span class="sc">::</span><span class="fu">compare_rma</span>(fit_ee, fit_re)  <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">5</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        fit_ee  fit_re</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; b     0.33385 0.33385</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; se    0.04688 0.04688</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; zval  7.12107 7.12107</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pval  0.00000 0.00000</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ci.lb 0.24196 0.24196</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ci.ub 0.42573 0.42573</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I2    0.00000 0.00000</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tau2  0.00000 0.00000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What do you think? are there differences between the two models? What could be the reasons?</p>
</section>
<section id="random-effects-model-in-r-2" class="level2">
<h2 class="anchored" data-anchor-id="random-effects-model-in-r-2">Random-effects model in R</h2>
<p>Clearly, given that we simulated <span class="math inline">\(\tau^2 = 0\)</span> the <code>RE</code> model results is very close (if not equal) to the <code>EE</code> model. We can simulate a <code>RE</code> model:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>tau2 <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">sim_studies</span>(<span class="at">k =</span> k, <span class="at">theta =</span> theta, <span class="at">tau2 =</span> tau2, <span class="at">n0 =</span> n, <span class="at">n1 =</span> n)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>fit_re <span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">method =</span> <span class="st">"REML"</span>, <span class="at">data =</span> dat)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_re)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Random-Effects Model (k = 30; tau^2 estimator: REML)</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   logLik  deviance       AIC       BIC      AICc   </span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -28.2810   56.5621   60.5621   63.2967   61.0236   </span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tau^2 (estimated amount of total heterogeneity): 0.3384 (SE = 0.1095)</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tau (square root of estimated tau^2 value):      0.5817</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I^2 (total heterogeneity / total variability):   84.00%</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H^2 (total variability / sampling variability):  6.25</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test for Heterogeneity:</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Q(df = 29) = 203.0597, p-val &lt; .0001</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Results:</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimate      se    zval    pval   ci.lb   ci.ub    </span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0.2965  0.1183  2.5071  0.0122  0.0647  0.5283  * </span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="forest-plot" class="level2">
<h2 class="anchored" data-anchor-id="forest-plot">Forest Plot</h2>
<p>The most common plot to represent meta-analysis results is the forest plot:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">forest</span>(fit_re)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-34-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="forest-plot-1" class="level2">
<h2 class="anchored" data-anchor-id="forest-plot-1">Forest Plot</h2>
<p>The most common plot to represent meta-analysis results is the forest plot:</p>
<ul>
<li>The <code>x</code> axis represent the <strong>effect size</strong></li>
<li>The <code>y</code> axis represent the <strong>studies</strong></li>
<li>The <code>size of the square</code> is the <strong>weight</strong> of that study (<span class="math inline">\(w_i = 1/\sigma_i^2\)</span>)</li>
<li>The <code>interval</code> is the <strong>95% confidence interval</strong></li>
<li>The <code>diamond</code> is the <strong>estimated effect and the 95% confidence interval</strong></li>
</ul>
</section>
<section id="forest-plot-2" class="level2">
<h2 class="anchored" data-anchor-id="forest-plot-2">Forest Plot</h2>
<p>It is also common to plot studies ordering by the size of the effect, showing asymmetries or other patterns:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">forest</span>(fit_re)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-35-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="multilab-studies" class="level1 section">
<h1 class="section">Multilab Studies</h1>
<section id="multilab-studies-1" class="level2">
<h2 class="anchored" data-anchor-id="multilab-studies-1">Multilab Studies</h2>
<p>So far we reasoned about collecting published studies and conducting a meta-analysis. Despite pooling evidence from multiple studies there are several limitations:</p>
<p>. . .</p>
<ul>
<li>publication bias</li>
</ul>
<p>. . .</p>
<ul>
<li>small number of studies (<span class="math inline">\(k\)</span>) thus low power and low estimation precision</li>
</ul>
<p>. . .</p>
<ul>
<li>the estimated <span class="math inline">\(\tau^2\)</span> could be high because the methdological heterogeneity is high â€“&gt; each research group use a different methodology</li>
</ul>
</section>
<section id="multilab-studies-2" class="level2">
<h2 class="anchored" data-anchor-id="multilab-studies-2">Multilab Studies</h2>
<p>With multilab studies we define a <strong>new data collection</strong> where different research group conduct an experiment with a <strong>similar (or the exact same) methodology</strong>. In this way we can:</p>
<p>. . .</p>
<ul>
<li>eliminate the <strong>publication bias</strong></li>
</ul>
<p>. . .</p>
<ul>
<li><strong>calibrate</strong> the number of studies (<span class="math inline">\(k\)</span>) and observations (<span class="math inline">\(n\)</span>) according to our criteria (power, precision, etc.)</li>
</ul>
</section>
<section id="multilab-studies-and-meta-analysis" class="level2">
<h2 class="anchored" data-anchor-id="multilab-studies-and-meta-analysis">Multilab Studies and meta-analysis</h2>
<p>From a statistical point of view, the only difference is the source of the data (planned and collected vs collected from the literature). In fact, a multilab study can be analyzed also using standard meta-analysis tools.</p>
<p>. . .</p>
<p>When intepreting the results we could highlight some differences:</p>
<p>. . .</p>
<ul>
<li><span class="math inline">\(\tau^2\)</span> in standard meta-analysis is considered the true variability of the phenomenon. In multilab studies (assuming an exact replication approach) should be low or close to zero.</li>
</ul>
<p>. . .</p>
<ul>
<li>In standard meta-analysis we could try to explain <span class="math inline">\(\tau^2\)</span> using meta-regression (e.g., putting the average participant age as predictor) while in multilab studies we could plan to use the same age thus removing the age effect.</li>
</ul>
</section>
<section id="extra---planning-a-multilab-study" class="level2 extra">
<h2 class="extra anchored" data-anchor-id="extra---planning-a-multilab-study">Extra - Planning a Multilab Study</h2>
<p>Letâ€™s imagine to plan a multilab study with the same setup as the previous meta-analysis. We are not collecting data from the literature but we want to know the number of studies <span class="math inline">\(k\)</span> that we need to achieve e.g.&nbsp;a good statistical Power.</p>
<p>. . .</p>
<p>We define power as the probability of correctly rejecting the null hypothesis of no effect when the effect is actually present</p>
</section>
<section id="extra---planning-a-multilab-study-1" class="level2 extra">
<h2 class="extra anchored" data-anchor-id="extra---planning-a-multilab-study-1">Extra - Planning a Multilab Study</h2>
<p>We can do a Power analysis using Monte Carlo simulations:</p>
<ol type="1">
<li>simulate a meta-analysis given a set of parameters</li>
<li>fit the meta-analysis model</li>
<li>extract the p-value</li>
<li>repeat the steps 1-3 a lot of times e.g.&nbsp;10000</li>
<li>count the number of significant (e.g., <span class="math inline">\(\leq \alpha\)</span>) p-values</li>
</ol>
</section>
<section id="extra---planning-a-multilab-study-2" class="level2 extra">
<h2 class="extra anchored" data-anchor-id="extra---planning-a-multilab-study-2">Extra - Planning a Multilab Study</h2>
<p>We can implement a simple simulation as:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(metafor)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(2023)</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">10</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">20</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>es <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>tau2 <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">expand_grid</span>(k, n, es, tau2)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>sim<span class="sc">$</span>power <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co"># handle errors, return NA</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>srma <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">possibly</span>(rma, <span class="at">otherwise =</span> <span class="cn">NA</span>)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(sim)){ <span class="co"># iterate for each condition</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  pval <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, nsim)</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim){ <span class="co"># iterate for each simulation</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    dat <span class="ot">&lt;-</span> <span class="fu">sim_studies</span>(<span class="at">k =</span> sim<span class="sc">$</span>k[i], </span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">theta =</span> sim<span class="sc">$</span>es[i], </span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tau2 =</span> sim<span class="sc">$</span>tau2[i],</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">n0 =</span> sim<span class="sc">$</span>n[i],</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>                       <span class="at">n1 =</span> sim<span class="sc">$</span>n[i])</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">srma</span>(yi, vi, <span class="at">data =</span> dat, <span class="at">method =</span> <span class="st">"REML"</span>)</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>    pval[j] <span class="ot">&lt;-</span> fit<span class="sc">$</span>pval</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>  sim<span class="sc">$</span>power[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(pval <span class="sc">&lt;=</span> alpha) <span class="co"># calculate power</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>  filor<span class="sc">::</span><span class="fu">pb</span>(<span class="fu">nrow</span>(sim), i)</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(sim, <span class="fu">here</span>(<span class="st">"04-meta-analysis/objects/power-example.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="extra---planning-a-multilab-study-3" class="level2 extra">
<h2 class="extra anchored" data-anchor-id="extra---planning-a-multilab-study-3">Extra - Planning a Multilab Study</h2>
<p>Then we can plot the results:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"slides/02-meta-analysis/objects/power-example.rds"</span>))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>title <span class="ot">&lt;-</span> <span class="st">"$</span><span class="sc">\\</span><span class="st">mu_</span><span class="sc">\\</span><span class="st">theta = 0.3$, $</span><span class="sc">\\</span><span class="st">tau^2 = 0.1$, $</span><span class="sc">\\</span><span class="st">alpha = 0.05"</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>sim <span class="sc">|&gt;</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> power, <span class="at">group =</span> n, <span class="at">color =</span> <span class="fu">factor</span>(n))) <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lwd =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Number of Studies (k)"</span>) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Sample Size"</span>) <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(latex2exp<span class="sc">::</span><span class="fu">TeX</span>(title))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-37-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="extra---planning-a-multilab-study-4" class="level2 extra">
<h2 class="extra anchored" data-anchor-id="extra---planning-a-multilab-study-4">Extra - Planning a Multilab Study</h2>
<p>This is a flexible way to simulate and plan a multilab study:</p>
<ul>
<li>We could prefer increasing <span class="math inline">\(k\)</span> (i.e., the research units) and limiting <span class="math inline">\(n\)</span> thus reducing the effort for each lab. The downside are difficulties in managing multiple labs, increased dropout rate, difficulty in reaching the planned <span class="math inline">\(k\)</span></li>
<li>We could prefer increasing <span class="math inline">\(n\)</span> and limiting <span class="math inline">\(k\)</span>. Each lab need to put more resources but the overall project could be easier.</li>
<li>We could try to estimate a cost function according to several parameters and find the best trade-off as implemented in <span class="citation" data-cites="Hedges2021-of">Hedges and Schauer (<a href="#ref-Hedges2021-of" role="doc-biblioref">2021</a>)</span></li>
</ul>
</section>
</section>
<section id="publication-bias-pb" class="level1 section">
<h1 class="section">Publication Bias (PB)</h1>
</section>
<section id="what-do-you-think-about-pb-what-do-you-know-causes-remedies" class="level1 question smaller">
<h1 class="question smaller">What do you think about PB? What do you know? Causes? Remedies?</h1>
<section id="publication-bias-pb-1" class="level2">
<h2 class="anchored" data-anchor-id="publication-bias-pb-1">Publication Bias (PB)</h2>
<p>The PB is one of the <strong>most problematic aspects</strong> of meta-analysis. Essentially <strong>the probability of publishing a paper</strong> (~and thus including into the meta-analysis) <span class="imp">is not the same regardless the result</span>. Clearly we could include also the gray literature to mitigate the problem.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-38-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="publication-bias-disclaimer" class="level2">
<h2 class="anchored" data-anchor-id="publication-bias-disclaimer">Publication Bias Disclaimer!</h2>
<p><strong>We cannot (completely) solve the PB using statistical tools</strong>. The PB is a problem related to the publishing process and publishing incentives (significant results are more catchy and easy to explain).</p>
<p>. . .</p>
<ul>
<li><strong>pre-registrations</strong>, <strong>multi-lab studies</strong>, etc. can (almost) completely solve the problem filling the literature with unbiased studies (at least from the publishing point of view)</li>
</ul>
<p>. . .</p>
<ul>
<li>there are <strong>statistical tools to detect, estimate and correct</strong> for the publication bias. As every statistical method, they are influenced by statistical assumptions, number of studies and sample size, heterogeneity, etc.</li>
</ul>
</section>
<section id="publication-bias-pb---the-big-picture" class="level2">
<h2 class="anchored" data-anchor-id="publication-bias-pb---the-big-picture">Publication Bias (PB) - The Big Picture<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/big-picture.svg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="publication-bias-pb---funnel-plot" class="level2">
<h2 class="anchored" data-anchor-id="publication-bias-pb---funnel-plot">Publication Bias (PB) - Funnel Plot</h2>
<p>The first tool is called <strong>funnel plot</strong>. This is a <strong>visual tool</strong> to check the presence of asymmetry that could be caused by publication bias. If meta-analysis assumptions are respected, and there is no publication bias:</p>
<ul>
<li>effects should be normally distributed around the average effect</li>
<li>more precise studies should be closer to the average effect</li>
<li>less precise studies could be equally distributed around the average effect</li>
</ul>
<p>Letâ€™s simulate a lot of studies to show:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2023</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">runif</span>(k, <span class="dv">10</span>, <span class="dv">200</span>))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">sim_studies</span>(<span class="at">k =</span> k, <span class="at">theta =</span> <span class="fl">0.5</span>, <span class="at">tau2 =</span> <span class="dv">0</span>, <span class="at">n0 =</span> n, <span class="at">n1 =</span> n)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">method =</span> <span class="st">"EE"</span>, <span class="at">data =</span> dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="publication-bias-pb---funnel-plot-1" class="level2">
<h2 class="anchored" data-anchor-id="publication-bias-pb---funnel-plot-1">Publication Bias (PB) - Funnel Plot</h2>
<p>Letâ€™s plot the distribution of the data:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dat<span class="sc">$</span>yi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-41-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>The distribution is clearly normal and centered on the true simulated value. Now letâ€™s add the precision (in this case standard error thus <span class="math inline">\(\sqrt{\sigma_i^2}\)</span>) on the y-axis.</p>
</section>
<section id="publication-bias-pb---funnel-plot-2" class="level2">
<h2 class="anchored" data-anchor-id="publication-bias-pb---funnel-plot-2">Publication Bias (PB) - Funnel Plot</h2>
<p>Note that the <code>y</code> axis is reversed so high-precise studies (<span class="math inline">\(\sqrt{\sigma_i^2}\)</span> close to 0) are on top.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>yi, dat<span class="sc">$</span>sei, <span class="at">ylim =</span> <span class="fu">rev</span>(<span class="fu">range</span>(dat<span class="sc">$</span>sei)),</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$y_i$"</span>),</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">sqrt{</span><span class="sc">\\</span><span class="st">sigma_i^2}$"</span>),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> scales<span class="sc">::</span><span class="fu">alpha</span>(<span class="st">"firebrick"</span>, <span class="fl">0.5</span>))</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> fit<span class="sc">$</span>b[[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="fl">1.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-42-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="publication-bias-pb---funnel-plot-3" class="level2">
<h2 class="anchored" data-anchor-id="publication-bias-pb---funnel-plot-3">Publication Bias (PB) - Funnel Plot</h2>
<p>The plot assume the typical funnel shape and there are not missing spots on the at the bottom. The presence of missing spots is a potential index of publication bias.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-43-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="publication-bias-pb---funnel-plot-4" class="level2">
<h2 class="anchored" data-anchor-id="publication-bias-pb---funnel-plot-4">Publication Bias (PB) - Funnel Plot</h2>
<p>The plot assume the typical funnel shape and there are not missing spots on the at the bottom. The presence of missing spots is a potential index of publication bias.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-44-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="robustness-to-pb---fail-safe-n" class="level2">
<h2 class="anchored" data-anchor-id="robustness-to-pb---fail-safe-n">Robustness to PB - Fail-safe N</h2>
<p>The Fail-safe N <span class="citation" data-cites="Rosenthal1979-yx">(<a href="#ref-Rosenthal1979-yx" role="doc-biblioref">Rosenthal 1979</a>)</span> idea is very simple. Given a meta-analysis with a significant result (i.e., <span class="math inline">\(p \leq \alpha\)</span>). How many null studies (i.e., <span class="math inline">\(\hat \theta = 0\)</span>) do I need to obtain <span class="math inline">\(p &gt; \alpha\)</span>?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>metafor<span class="sc">::</span><span class="fu">fsn</span>(yi, vi, <span class="at">data =</span> dat)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fail-safe N Calculation Using the Rosenthal Approach</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Observed Significance Level: &lt;.0001</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Target Significance Level:   0.05</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fail-safe N: 4396757</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="robustness-to-pb---fail-safe-n-1" class="level2">
<h2 class="anchored" data-anchor-id="robustness-to-pb---fail-safe-n-1">Robustness to PB - Fail-safe N</h2>
<p>There are several criticism to the Fail-safe N procedure:</p>
<p>. . .</p>
<ul>
<li>is not actually <em>detecting</em> the PB but suggesting the required PB size to remove the effect. A very large N suggest that even with PB, it is unlikely that the results could be completely changed by actually reporting null studies</li>
</ul>
<p>. . .</p>
<ul>
<li><span class="citation" data-cites="Orwin1983-vu">Orwin (<a href="#ref-Orwin1983-vu" role="doc-biblioref">1983</a>)</span> proposed a new method calculating the number of studies required to reduce the effect size to a given target</li>
</ul>
<p>. . .</p>
<ul>
<li><span class="citation" data-cites="Rosenberg2005-ie">Rosenberg (<a href="#ref-Rosenberg2005-ie" role="doc-biblioref">2005</a>)</span> proposed a method similar to Rosenthal <span class="citation" data-cites="Rosenthal1979-yx">(<a href="#ref-Rosenthal1979-yx" role="doc-biblioref">1979</a>)</span> but combining the (weighted) effect sizes and not the p-values.</li>
</ul>
</section>
<section id="detecting-pb---egger-regression" class="level2">
<h2 class="anchored" data-anchor-id="detecting-pb---egger-regression">Detecting PB - Egger Regression</h2>
<p>A basic method to test the funnel plot asymmetry is using an the <strong>Egger regression test</strong>. Basically we calculate the relationship between <span class="math inline">\(y_i\)</span> and <span class="math inline">\(\sqrt{\sigma^2_i}\)</span>. In the absence of asimmetry, the line slope should be not different from 0.</p>
<p>We can use the <code>metafor::regtest()</code> function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>egger <span class="ot">&lt;-</span> <span class="fu">regtest</span>(fit)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>egger</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Regression Test for Funnel Plot Asymmetry</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model:     fixed-effects meta-regression model</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Predictor: standard error</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test for Funnel Plot Asymmetry: z = 1.0847, p = 0.2781</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Limit Estimate (as sei -&gt; 0):   b = 0.4821 (CI: 0.4521, 0.5122)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="publication-bias-pb---egger-regression" class="level2">
<h2 class="anchored" data-anchor-id="publication-bias-pb---egger-regression">Publication Bias (PB) - Egger Regression</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-47-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>This is a standard (meta) regression thus the number of studies, the precision of each study and heterogeneity influence the reliability (power, type-1 error rate, etc.) of the procedure.</p>
</section>
<section id="correcting-pb---trim-and-fill" class="level2">
<h2 class="anchored" data-anchor-id="correcting-pb---trim-and-fill">Correcting PB - Trim and Fill</h2>
<p>The Trim and Fill method <span class="citation" data-cites="Duval2000-ym">(<a href="#ref-Duval2000-ym" role="doc-biblioref">Duval and Tweedie 2000</a>)</span> is used to impute the hypothetical missing studies according to the funnel plot and recomputing the meta-analysis effect. Shi and Lin <span class="citation" data-cites="Shi2019-pj">(<a href="#ref-Shi2019-pj" role="doc-biblioref">Shi and Lin 2019</a>)</span> provide an updated overview of the method with some criticisms.</p>
<p>. . .</p>
<p>Letâ€™s simulate again a <strong>publication</strong> bias with <span class="math inline">\(k = 100\)</span> studies:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2023</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># we increased k to better show the effect</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>tau2 <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">sim_pub_bias</span>(<span class="at">selmodel =</span> <span class="fu">list</span>(<span class="at">method =</span> <span class="st">"2step"</span>, <span class="at">param =</span> <span class="st">"pval"</span>, <span class="at">th =</span> <span class="fl">0.05</span>, <span class="at">side =</span> <span class="st">"&lt;="</span>), <span class="at">k =</span> k, <span class="at">theta =</span> theta, <span class="at">tau2 =</span> tau2, <span class="at">nmin =</span> <span class="dv">10</span>, <span class="at">nmax =</span> <span class="dv">200</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">data =</span> dat, <span class="at">method =</span> <span class="st">"REML"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="correcting-pb---trim-and-fill-1" class="level2">
<h2 class="anchored" data-anchor-id="correcting-pb---trim-and-fill-1">Correcting PB - Trim and Fill</h2>
<p>Now we can use the <code>metafor::trimfill()</code> function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>taf <span class="ot">&lt;-</span> metafor<span class="sc">::</span><span class="fu">trimfill</span>(fit)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>taf</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimated number of missing studies on the left side: 29 (SE = 6.4513)</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Random-Effects Model (k = 129; tau^2 estimator: REML)</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tau^2 (estimated amount of total heterogeneity): 0.1382 (SE = 0.0203)</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tau (square root of estimated tau^2 value):      0.3718</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I^2 (total heterogeneity / total variability):   88.56%</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H^2 (total variability / sampling variability):  8.74</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test for Heterogeneity:</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Q(df = 128) = 1073.8812, p-val &lt; .0001</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Results:</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimate      se     zval    pval   ci.lb   ci.ub      </span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0.4851  0.0357  13.5951  &lt;.0001  0.4152  0.5551  *** </span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The trim-and-fill estimates that 29 are missing. The new effect size after including the studies is reduced and closer to the simulated value (but in this case still significant).</p>
</section>
<section id="correcting-pb---trim-and-fill-2" class="level2">
<h2 class="anchored" data-anchor-id="correcting-pb---trim-and-fill-2">Correcting PB - Trim and Fill</h2>
<p>We can also visualize the funnel plot highligting the points that are included by the method.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">funnel</span>(taf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">funnel</span>(taf)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>egg <span class="ot">&lt;-</span> <span class="fu">regtest</span>(fit)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>egg_npb <span class="ot">&lt;-</span> <span class="fu">regtest</span>(taf)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">1.8</span>,<span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">coef</span>(egg<span class="sc">$</span>fit)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(egg<span class="sc">$</span>fit)[<span class="dv">2</span>]<span class="sc">*</span>se, se, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col =</span> <span class="st">"black"</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">coef</span>(egg_npb<span class="sc">$</span>fit)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(egg_npb<span class="sc">$</span>fit)[<span class="dv">2</span>]<span class="sc">*</span>se, se, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col =</span> <span class="st">"firebrick"</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Original"</span>, <span class="st">"Corrected"</span>), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"firebrick"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-51-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="correcting-pb---selection-models-sm" class="level2">
<h2 class="anchored" data-anchor-id="correcting-pb---selection-models-sm">Correcting PB - Selection Models (SM)</h2>
<p>. . .</p>
<ul>
<li>SM assume a <strong>relationship between the p-value and the probability of publishing</strong></li>
</ul>
<p>. . .</p>
<ul>
<li>SM <strong>estimate this relationship</strong> from available studies and <strong>correct the average effect</strong></li>
</ul>
<p>. . .</p>
<div class="cons">
<ul>
<li>The models are complicated (number of parameters) and need a large <span class="math inline">\(k\)</span></li>
</ul>
</div>
<p>. . .</p>
<div class="pros">
<ul>
<li>They provide a very elegant framework to formalize the publication bias supporting simulations and methods development</li>
</ul>
</div>
</section>
<section id="sm---publication-bias-function" class="level2">
<h2 class="anchored" data-anchor-id="sm---publication-bias-function">SM - Publication Bias Function</h2>
<ul>
<li>The publication bias can be formalized using a <strong>weight function</strong> that assign a probability to a certain study properties (e.g., p-value, sample size, z-score, etc.) representing the likelihood of that study being published.</li>
</ul>
<p>. . .</p>
<ul>
<li>The general idea <span class="citation" data-cites="Citkowicz2017-ox">(e.g., <a href="#ref-Citkowicz2017-ox" role="doc-biblioref">Citkowicz and Vevea 2017</a>)</span> is to use a weighted probability density function (wPDF). In the presence of publication bias, the parameters of the wPDF will be different (i.e., adjusted) compared to unweighted PDF (i.e., assuming no publication bias)</li>
</ul>
</section>
<section id="sm---publication-bias-function-1" class="level2">
<h2 class="anchored" data-anchor-id="sm---publication-bias-function-1">SM - Publication Bias Function</h2>
<p>The random-effect meta-analysis PDF can be written as <span class="citation" data-cites="Citkowicz2017-ox">(e.g., <a href="#ref-Citkowicz2017-ox" role="doc-biblioref">Citkowicz and Vevea 2017</a>)</span>:</p>
<p><span class="math display">\[
f\left(y_i \mid \beta, \tau^2 ; \sigma_i^2\right)=\phi\left(\frac{y_i-\Delta_i}{\sqrt{\sigma_i^2+\tau^2}}\right) / \sqrt{\sigma_i^2+\tau^2},
\]</span></p>
<p>And adding the weight function:</p>
<p><span class="math display">\[
f\left(Y_i \mid \beta, \tau^2 ; \sigma_i^2\right)=\frac{\mathrm{w}\left(p_i\right) \phi\left(\frac{y_i-\Delta_i}{\sqrt{\sigma_i^2+\tau^2}}\right) / \sqrt{\sigma_i^2+\tau^2}}{\int_{-\infty}^{\infty} \mathrm{w}\left(p_i\right) \phi\left(\frac{Y_i-\Delta_i}{\sqrt{\sigma_i^2+\tau^2}}\right) / \sqrt{\sigma_i^2+\tau^2} d Y_i}
\]</span></p>
</section>
<section id="sec-pub-bias-fun" class="level2">
<h2 class="anchored" data-anchor-id="sec-pub-bias-fun">SM - Publication Bias Function</h2>
<p>For example, Citkowicz and Vevea <span class="citation" data-cites="Citkowicz2017-ox">(<a href="#ref-Citkowicz2017-ox" role="doc-biblioref">2017</a>)</span> proposed a model using a weight function based on the Beta distribution with two parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span><a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> <span class="math inline">\(w(p_i) = p_i^{a - 1} \times (1 - p_i)^{b - 1}\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-52-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="selection-models" class="level2">
<h2 class="anchored" data-anchor-id="selection-models">Selection Models</h2>
<p>In R we can use the <code>metafor::selmodel()</code> function to implement several type of models. For example we can apply the Citkowicz and Vevea <span class="citation" data-cites="Citkowicz2017-ox">(<a href="#ref-Citkowicz2017-ox" role="doc-biblioref">2017</a>)</span> model:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>sel_beta <span class="ot">&lt;-</span> <span class="fu">selmodel</span>(fit, <span class="at">type =</span> <span class="st">"beta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Results</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell" data-layout-align="center">
<pre><code>#&gt; 
#&gt; Random-Effects Model (k = 100; tau^2 estimator: ML)
#&gt; 
#&gt; tau^2 (estimated amount of total heterogeneity): 0.0857 (SE = 0.0255)
#&gt; tau (square root of estimated tau^2 value):      0.2928
#&gt; 
#&gt; Test for Heterogeneity:
#&gt; LRT(df = 1) = 293.8104, p-val &lt; .0001
#&gt; 
#&gt; Model Results:
#&gt; 
#&gt; estimate      se    zval    pval   ci.lb   ci.ub      
#&gt;   0.4847  0.1020  4.7521  &lt;.0001  0.2848  0.6846  *** 
#&gt; 
#&gt; Test for Selection Model Parameters:
#&gt; LRT(df = 2) = 14.3271, p-val = 0.0008
#&gt; 
#&gt; Selection Model Results:
#&gt; 
#&gt;          estimate      se     zval    pval   ci.lb   ci.ub     
#&gt; delta.1    0.8174  0.0700  -2.6075  0.0091  0.6802  0.9547  ** 
#&gt; delta.2    0.7017  0.2009  -1.4846  0.1376  0.3080  1.0955     
#&gt; 
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sel_beta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-55-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="selection-models-1" class="level2">
<h2 class="anchored" data-anchor-id="selection-models-1">Selection Models</h2>
<p>Letâ€™s try the Beta selection model without publication bias:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2023</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">sim_studies</span>(<span class="dv">30</span>, <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">30</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">data =</span> dat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>sel_beta <span class="ot">&lt;-</span> <span class="fu">selmodel</span>(fit, <span class="at">type =</span> <span class="st">"beta"</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sel_beta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-56-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="more-on-sm-and-publication-bias" class="level2">
<h2 class="anchored" data-anchor-id="more-on-sm-and-publication-bias">More on SM and Publication Bias</h2>
<ul>
<li>The SM documentation of <code>metafor::selmodel()</code> <a href="https://www.youtube.com/watch?v=ucmOCuyCk-c">https://wviechtb.github.io/metafor/reference/selmodel.html</a></li>
<li>Wolfgang Viechtbauer overview of PB <a href="https://www.youtube.com/watch?v=ucmOCuyCk-c">https://www.youtube.com/watch?v=ucmOCuyCk-c</a></li>
<li><span class="citation" data-cites="Harrer2021-go">Harrer et al. (<a href="#ref-Harrer2021-go" role="doc-biblioref">2021</a>)</span> - Doing Meta-analysis in R - <a href="https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/pub-bias.html">Chapter 9</a></li>
<li><span class="citation" data-cites="McShane2016-bk">McShane, BÃ¶ckenholt, and Hansen (<a href="#ref-McShane2016-bk" role="doc-biblioref">2016</a>)</span> for a nice introduction about publication bias and SM</li>
<li>Another good overview by <span class="citation" data-cites="Jin2015-ik">Jin, Zhou, and He (<a href="#ref-Jin2015-ik" role="doc-biblioref">2015</a>)</span></li>
<li>See also <span class="citation" data-cites="Guan2016-kn">Guan and Vandekerckhove (<a href="#ref-Guan2016-kn" role="doc-biblioref">2016</a>)</span>, <span class="citation" data-cites="Maier2023-js">Maier, BartoÅ¡, and Wagenmakers (<a href="#ref-Maier2023-js" role="doc-biblioref">2023</a>)</span> and <span class="citation" data-cites="Bartos2022-im">BartoÅ¡ et al. (<a href="#ref-Bartos2022-im" role="doc-biblioref">2022</a>)</span> for Bayesian approaches to PB</li>
</ul>
</section>
<section id="more-on-sm-and-publication-bias-1" class="level2">
<h2 class="anchored" data-anchor-id="more-on-sm-and-publication-bias-1">More on SM and Publication Bias</h2>
<p>Assessing, testing and developing sofisticated models for publication bias is surely important and interesting. But as Wolfgang Viechtbauer (the author of <code>metafor</code>) said:</p>
<blockquote class="blockquote">
<p>hopefully there wonâ€™t be need for these models in the future <span class="citation" data-cites="Viechtbauer2021-od">(<a href="#ref-Viechtbauer2021-od" role="doc-biblioref">Viechtbauer 2021</a>)</span></p>
</blockquote>
</section>
<section id="extra---simulating-publication-bias" class="level2 extra">
<h2 class="extra anchored" data-anchor-id="extra---simulating-publication-bias">Extra - Simulating Publication Bias</h2>
<p>I wrote two custom functions to generate a biased dataset based on different criteria:</p>
<ul>
<li>a simple step function with a threshold (e.g., <span class="math inline">\(p \leq 0.05\)</span> then 1 else 0)</li>
<li>the weight function from slide <a href="#sec-pub-bias-fun" class="quarto-xref">Slide&nbsp;6.19</a></li>
<li>a custom criterion (e.g., select only <span class="math inline">\(|y_i| &gt; 0.5\)</span>)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>weigth_beta <span class="ot">&lt;-</span> <span class="cf">function</span>(x, a, b){</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span>(a <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> x)<span class="sc">^</span>(b <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>weigth_2step <span class="ot">&lt;-</span> <span class="cf">function</span>(x, th, <span class="at">side =</span> <span class="st">"&lt;="</span>){</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(<span class="fu">eval</span>(<span class="fu">call</span>(side, x, th)), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>â€¦continue</p>
</section>
<section id="extra---simulating-publication-bias-1" class="level2 extra">
<h2 class="extra anchored" data-anchor-id="extra---simulating-publication-bias-1">Extra - Simulating Publication Bias</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>sim_pub_bias <span class="ot">&lt;-</span> <span class="cf">function</span>(selmodel,</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>                         k, </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                         theta, </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                         tau2, </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                         nmin, </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                         nmax){</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  selmodel<span class="sc">$</span>method <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(selmodel<span class="sc">$</span>method, <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">"custom"</span>, <span class="st">"2step"</span>, <span class="st">"beta"</span>))</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"list"</span>, <span class="at">length =</span> k)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(i <span class="sc">&lt;=</span> k){</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="dv">1</span>, nmin, nmax))</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    dat_i <span class="ot">&lt;-</span> <span class="fu">sim_studies</span>(<span class="at">k =</span> <span class="dv">1</span>, <span class="at">theta =</span> theta, <span class="at">tau2 =</span> tau2, <span class="at">n0 =</span> n, <span class="at">n1 =</span> n)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    dat_i<span class="sc">$</span>n <span class="ot">&lt;-</span> n</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>    dat_i <span class="ot">&lt;-</span> metafor<span class="sc">::</span><span class="fu">escalc</span>(<span class="at">yi =</span> yi, <span class="at">vi =</span> vi, <span class="at">sei =</span> sei, <span class="at">data =</span> dat_i)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>    dat_i <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">summary</span>(dat_i))</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(selmodel<span class="sc">$</span>method <span class="sc">==</span> <span class="st">"2step"</span>){</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>      ppub <span class="ot">&lt;-</span> <span class="fu">weigth_2step</span>(<span class="at">x =</span> dat_i[[selmodel<span class="sc">$</span>param]], <span class="at">th =</span> selmodel<span class="sc">$</span>th, <span class="at">side =</span> selmodel<span class="sc">$</span>side)</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span> <span class="cf">if</span>(selmodel<span class="sc">$</span>method <span class="sc">==</span> <span class="st">"beta"</span>){</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>      ppub <span class="ot">&lt;-</span> <span class="fu">weigth_beta</span>(<span class="at">x =</span> dat_i<span class="sc">$</span>pval, <span class="at">a =</span> selmodel<span class="sc">$</span>a, <span class="at">b =</span> selmodel<span class="sc">$</span>b)</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>      ppub <span class="ot">&lt;-</span> <span class="fu">with</span>(dat_i, <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> selmodel<span class="sc">$</span>operation)))</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, ppub) <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>      res[[i]] <span class="ot">&lt;-</span> dat_i</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>      i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, res)</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(dat)</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="extra---simulating-publication-bias-2" class="level2 extra">
<h2 class="extra anchored" data-anchor-id="extra---simulating-publication-bias-2">Extra - Simulating Publication Bias</h2>
<p>For example, letâ€™s simulate a pretty simple publication bias model where we included <span class="math inline">\(k = 40\)</span> studies. The biased criteria is that only <span class="math inline">\(p \leq 0.05\)</span> are included.</p>
<ul>
<li><span class="math inline">\(\theta = 0.5\)</span></li>
<li><span class="math inline">\(\tau^2 = 0\)</span> i.e.&nbsp;an EE model</li>
<li><span class="math inline">\(n \sim \mathcal{U}(10, 200)\)</span></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-59-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="extra---simulating-publication-bias-3" class="level2 extra">
<h2 class="extra anchored" data-anchor-id="extra---simulating-publication-bias-3">Extra - Simulating Publication Bias</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2023</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>tau2 <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">sim_pub_bias</span>(<span class="at">selmodel =</span> <span class="fu">list</span>(<span class="at">method =</span> <span class="st">"2step"</span>, <span class="at">param =</span> <span class="st">"pval"</span>, <span class="at">th =</span> <span class="fl">0.05</span>, <span class="at">side =</span> <span class="st">"&lt;="</span>), <span class="at">k =</span> k, <span class="at">theta =</span> theta, <span class="at">tau2 =</span> tau2, <span class="at">nmin =</span> <span class="dv">10</span>, <span class="at">nmax =</span> <span class="dv">200</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>filor<span class="sc">::</span><span class="fu">trim_df</span>(dat)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      yi    vi   sei   n    zi  pval ci.lb ci.ub</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 0.352  0.02  0.14  99  2.52 0.012 0.078 0.627</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 0.605 0.022 0.147  91 4.103     0 0.316 0.894</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 1.714 0.038 0.195  44  8.81     0 1.333 2.096</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 0.697 0.027 0.166  71 4.208     0 0.372 1.022</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   ...   ...   ... ...   ...   ...   ...   ...</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 0.682 0.026 0.161  70 4.239     0 0.367 0.997</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 0.888 0.108 0.329  28 2.698 0.007 0.243 1.533</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8 1.033 0.089 0.298  21 3.464 0.001 0.449 1.618</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9 0.974  0.01   0.1 181 9.722     0 0.777  1.17</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="extra---simulating-publication-bias-4" class="level2 extra">
<h2 class="extra anchored" data-anchor-id="extra---simulating-publication-bias-4">Extra - Simulating Publication Bias</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">data =</span> dat)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Random-Effects Model (k = 100; tau^2 estimator: REML)</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   logLik  deviance       AIC       BIC      AICc   </span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -28.2354   56.4709   60.4709   65.6611   60.5959   </span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tau^2 (estimated amount of total heterogeneity): 0.0811 (SE = 0.0145)</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tau (square root of estimated tau^2 value):      0.2847</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I^2 (total heterogeneity / total variability):   82.87%</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; H^2 (total variability / sampling variability):  5.84</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test for Heterogeneity:</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Q(df = 99) = 583.0508, p-val &lt; .0001</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model Results:</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimate      se     zval    pval   ci.lb   ci.ub      </span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0.6232  0.0321  19.4055  &lt;.0001  0.5603  0.6862  *** </span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Clearly, <span class="math inline">\(\theta\)</span> is overestimated because we are systematic omitting non-significant p-values. These studies are more likely to be imprecise studies thus we are probably creating a funnel plot asymmetry.</p>
</section>
<section id="extra---simulating-publication-bias-5" class="level2 extra">
<h2 class="extra anchored" data-anchor-id="extra---simulating-publication-bias-5">Extra - Simulating Publication Bias</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>egger <span class="ot">&lt;-</span> <span class="fu">regtest</span>(fit)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">funnel</span>(fit, <span class="at">cex.lab =</span> <span class="fl">1.2</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">1.8</span>,<span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">coef</span>(egger<span class="sc">$</span>fit)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(egger<span class="sc">$</span>fit)[<span class="dv">2</span>]<span class="sc">*</span>se, se, <span class="at">lwd=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-meta-analysis_files/figure-revealjs/unnamed-chunk-62-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="practical-meta-analysis" class="level1 section">
<h1 class="section">Practical meta-analysis</h1>
<section id="oliveira2023-yf-dataset" class="level2">
<h2 class="anchored" data-anchor-id="oliveira2023-yf-dataset"><span class="citation" data-cites="Oliveira2023-yf">Oliveira et al. (<a href="#ref-Oliveira2023-yf" role="doc-biblioref">2023</a>)</span> dataset</h2>
<p>The meta-analysis by <span class="citation" data-cites="Oliveira2023-yf">Oliveira et al. (<a href="#ref-Oliveira2023-yf" role="doc-biblioref">2023</a>)</span> is about the efficacy of Internet-delivered cognitive behavioral therapy (ICBT) interventions in reducing anxiety among university students. They collected <span class="math inline">\(k = 15\)</span> studies with a total of 1619 participants and summarized the effect using a standardized mean difference. The dataset is <code>02-meta-analysis/objects/oliveira2023.rds</code>. You can also load it using <code>data(oliveira2023)</code>:</p>
<div class="cell" data-layout-align="center">
<pre><code>#&gt; 
#&gt;                 Study Year Target.outcome          Outcome  Measures mean.age 
#&gt; 1      Botella et al. 2010            SAD Anxiety disorder SAD-scale    24.40 
#&gt; 2          Day et al. 2013        Anxiety Anxiety symptoms   DASS-21    23.55 
#&gt; 3        Ellis et al. 2011        Anxiety Anxiety symptoms   DASS-21    19.67 
#&gt; 4  Fitzpatrick et al. 2017        Anxiety Anxiety symptoms     GAD-7     22.2 
#&gt; 5       KÃ¤hlke et al. 2019            SAD Anxiety disorder      SIAS    26.70 
#&gt; 6          Liu et al. 2020        Anxiety Anxiety symptoms    STAI-S     22.0 
#&gt; 7       McCall et al. 2018            SAD Anxiety disorder      SIAS    21.86 
#&gt; 8      McCloud et al. 2020        Anxiety Anxiety symptoms      HADS     24.3 
#&gt; 9       Melnyk et al. 2015        Anxiety Anxiety symptoms     GAD-7    18.67 
#&gt; 10      Morris et al. 2016        Anxiety Anxiety symptoms    STAI-S     20.5 
#&gt; 11      Mullin et al. 2015        Anxiety Anxiety symptoms     GAD-7    27.86 
#&gt; 12      Newman et al. 2021            GAD Anxiety disorder     GAD-7    19.91 
#&gt; 13      Orbach et al. 2007   Test anxiety Anxiety disorder       TAI    23.67 
#&gt; 14    Richards et al. 2016            GAD Anxiety disorder     GAD-7    23.82 
#&gt; 15       Sethi et al. 2010        Anxiety Anxiety symptoms   DASS-21    19.47 
#&gt;    sample.type guidance      lenght riskofbias control.group n.exp.pos 
#&gt; 1      general        n   5-8 weeks        Low       passive        30 
#&gt; 2      general      yes   5-8 weeks        Low       passive        33 
#&gt; 3        other      yes &lt; = 4 weeks        Low       passive        13 
#&gt; 4      general        n &lt; = 4 weeks        Low        active        31 
#&gt; 5      general        n  &gt;= 9 weeks        Low       passive       100 
#&gt; 6      general      yes &lt; = 4 weeks   Concerns       passive        40 
#&gt; 7        other        n  &gt;= 9 weeks   Concerns       passive        30 
#&gt; 8      general        n   5-8 weeks   Concerns       passive        58 
#&gt; 9      general        n   5-8 weeks   Concerns        active        61 
#&gt; 10     general        n   5-8 weeks   Concerns       passive        43 
#&gt; 11     general      yes  &gt;= 9 weeks        Low       passive        30 
#&gt; 12       other      yes  &gt;= 9 weeks        Low       passive       117 
#&gt; 13     general        n   5-8 weeks        Low        active        30 
#&gt; 14     general      yes   5-8 weeks        Low       passive        70 
#&gt; 15       other      yes &lt; = 4 weeks   Concerns       passive         9 
#&gt;    mean.exp.pos sd.exp.pos n.control.pos mean.control.pos sd.control.pos 
#&gt; 1          7.67       5.81            25            11.28           7.45 
#&gt; 2          5.70       4.49            33             9.93           7.77 
#&gt; 3          4.46       4.91            13             9.39           5.06 
#&gt; 4         17.35       0.60            25            16.84           0.67 
#&gt; 5         36.72      13.86           100            44.36          14.05 
#&gt; 6         41.10      10.40            14            51.90           8.70 
#&gt; 7         30.73      11.12            35            41.43          13.82 
#&gt; 8         11.20       3.75            70            12.60           3.88 
#&gt; 9          4.90       3.90            32             5.40           4.70 
#&gt; 10        45.81      11.43            47            53.09          11.25 
#&gt; 11         6.09       4.01            23             8.35           5.60 
#&gt; 12         5.89       3.16           105             6.82           3.10 
#&gt; 13        47.31       9.49            28            54.25          11.31 
#&gt; 14         7.73       4.44            67             9.13           4.13 
#&gt; 15         8.60       4.10            10            13.80           3.80 
#&gt;         yi     vi 
#&gt; 1  -0.5389 0.0760 
#&gt; 2  -0.6588 0.0639 
#&gt; 3  -0.9576 0.1715 
#&gt; 4   0.7956 0.0779 
#&gt; 5  -0.5454 0.0207 
#&gt; 6  -1.0641 0.1069 
#&gt; 7  -0.8358 0.0673 
#&gt; 8  -0.3641 0.0320 
#&gt; 9  -0.1184 0.0477 
#&gt; 10 -0.6367 0.0468 
#&gt; 11 -0.4676 0.0789 
#&gt; 12 -0.2959 0.0183 
#&gt; 13 -0.6579 0.0728 
#&gt; 14 -0.3244 0.0296 
#&gt; 15 -1.2593 0.2528</code></pre>
</div>
</section>
<section id="oliveira2023-yf-dataset-1" class="level2">
<h2 class="anchored" data-anchor-id="oliveira2023-yf-dataset-1"><span class="citation" data-cites="Oliveira2023-yf">Oliveira et al. (<a href="#ref-Oliveira2023-yf" role="doc-biblioref">2023</a>)</span> dataset</h2>
<p>There are multiple columns with study-level features but the important variables are:</p>
<ul>
<li><code>study</code>: identifier for each study</li>
<li><code>yi</code>: the standardized effect size. Negative effect represent a reduction of pre-post anxiety</li>
<li><code>vi</code>: the standardized effect size sampling variance</li>
</ul>
</section>
<section id="steps" class="level2">
<h2 class="anchored" data-anchor-id="steps">Steps</h2>
<ol type="1">
<li>Import the data and explore (summary statistics, plots, etc.) the variables</li>
<li>Fit an equal-effects model and a random-effects model
<ol type="1">
<li>Intepret the results</li>
<li>Intepret the heterogeneity (if relevant)</li>
<li>Compare the two models. Is there any difference? Which model is more appropriate</li>
</ol></li>
<li>Plot the model results using a forest plot</li>
<li>Create a funnel plot and comment the pattern</li>
<li>Analyze the publication bias using the Egger regression and comment the result</li>
<li>Try to apply the trim and fill method and comment the result</li>
</ol>
</section>
<section id="dear2019-qc-dataset" class="level2">
<h2 class="anchored" data-anchor-id="dear2019-qc-dataset"><span class="citation" data-cites="Dear2019-qc">Dear, Dutton, and Fox (<a href="#ref-Dear2019-qc" role="doc-biblioref">2019</a>)</span> dataset</h2>
<blockquote class="blockquote">
<p>Eye cues have been shown to stimulate rapid, reflexive, unconscious processing and in many experimental settings to cue increased prosocial and decreased antisocial behaviour <span class="citation" data-cites="Dear2019-qc">(<a href="#ref-Dear2019-qc" role="doc-biblioref">Dear, Dutton, and Fox 2019</a>)</span>.</p>
</blockquote>
<blockquote class="blockquote">
<p>The â€œwatching eyesâ€ effect refers to a strange phenomenon whereby the mere presence of pictures of eyes or stylized eye images is enough to cause people to adjust their behavior</p>
</blockquote>
<ul>
<li>they found <span class="math inline">\(k = 15\)</span> studies with a total of 2035 participants</li>
<li>compared to previous examples, the included studies used a 2x2 design and the effect size is calculated counting the number of people doing antisocial actions (or not) according to the experimental condition (with and without eye cues).</li>
<li>the effect size is the <span class="math inline">\(log\)</span> Odds Ratio and can be calculated using <code>metafor::escalc()</code></li>
</ul>
</section>
<section id="dear2019-qc-dataset-1" class="level2">
<h2 class="anchored" data-anchor-id="dear2019-qc-dataset-1"><span class="citation" data-cites="Dear2019-qc">Dear, Dutton, and Fox (<a href="#ref-Dear2019-qc" role="doc-biblioref">2019</a>)</span> dataset</h2>
<p>The dataset can be found in <code>02-meta-analysis/objects/dear2019.rds</code> or using <code>data(dear2019)</code>:</p>
<div class="cell" data-layout-align="center">
<pre><code>#&gt;                        Citation N.NO.EYES CTRL.ASB.YES CTRL.ASB.N N.EYES
#&gt; 1  ErnestJones.etal.2011.Litter       289           98        175    273
#&gt; 2      Bateson.etal.2013.Litter       297           83        214    305
#&gt; 3          Baillon.etal2013.JoD        49           19         30     51
#&gt; 4         Zengerink.2013.Litter       314          170        144    630
#&gt; 5 Bateson.etal.2015.Litter.Exp1       137           23        114    147
#&gt; 6 Bateson.etal.2015.Litter.Exp2        97           25         72    216
#&gt;   EYES.ASB.YES EYES.ASB.NO
#&gt; 1           56         233
#&gt; 2           80         225
#&gt; 3            9          42
#&gt; 4          297         333
#&gt; 5            8         139
#&gt; 6           31         185</code></pre>
</div>
</section>
<section id="steps-1" class="level2">
<h2 class="anchored" data-anchor-id="steps-1">Steps</h2>
<ol type="1">
<li>Import the data and explore (summary statistics, plots, etc.) the variables</li>
<li>Try to calculate the effect size (log Odds Ratio) using <code>metafor::escalc()</code> (see the documentation <code>?metafor::escalc()</code>)</li>
<li>Do the same steps as the previous meta-analysis</li>
</ol>
</section>
<section id="references-download-.bib-file" class="level2 smaller">




</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References  Download .bib file</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Bartos2022-im" class="csl-entry" role="listitem">
BartoÅ¡, FrantiÅ¡ek, Maximilian Maier, Daniel S Quintana, and Eric-Jan Wagenmakers. 2022. <span>â€œAdjusting for Publication Bias in <span>JASP</span> and r: Selection Models, <span>PET-PEESE</span>, and Robust Bayesian Meta-Analysis.â€</span> <em>Adv. Methods Pract. Psychol. Sci.</em> 5 (3): 251524592211092. <a href="https://doi.org/10.1177/25152459221109259">https://doi.org/10.1177/25152459221109259</a>.
</div>
<div id="ref-Borenstein2009-mo" class="csl-entry" role="listitem">
Borenstein, Michael, Larry V Hedges, Julian P T Higgins, and Hannah R Rothstein. 2009. <span>â€œIntroduction to <span>Meta-Analysis</span>.â€</span> <a href="https://doi.org/10.1002/9780470743386">https://doi.org/10.1002/9780470743386</a>.
</div>
<div id="ref-Citkowicz2017-ox" class="csl-entry" role="listitem">
Citkowicz, Martyna, and Jack L Vevea. 2017. <span>â€œA Parsimonious Weight Function for Modeling Publication Bias.â€</span> <em>Psychol. Methods</em> 22 (1): 28â€“41. <a href="https://doi.org/10.1037/met0000119">https://doi.org/10.1037/met0000119</a>.
</div>
<div id="ref-Dear2019-qc" class="csl-entry" role="listitem">
Dear, Keith, Kevin Dutton, and Elaine Fox. 2019. <span>â€œDo <span>â€˜Watching Eyesâ€™</span> Influence Antisocial Behavior? A Systematic Review &amp; Meta-Analysis.â€</span> <em>Evol. Hum. Behav.</em> 40 (3): 269â€“80. <a href="https://doi.org/10.1016/j.evolhumbehav.2019.01.006">https://doi.org/10.1016/j.evolhumbehav.2019.01.006</a>.
</div>
<div id="ref-Duval2000-ym" class="csl-entry" role="listitem">
Duval, S, and R Tweedie. 2000. <span>â€œTrim and Fill: A Simple Funnel-Plot-Based Method of Testing and Adjusting for Publication Bias in Meta-Analysis.â€</span> <em>Biometrics</em> 56 (2): 455â€“63. <a href="https://doi.org/10.1111/j.0006-341x.2000.00455.x">https://doi.org/10.1111/j.0006-341x.2000.00455.x</a>.
</div>
<div id="ref-Guan2016-kn" class="csl-entry" role="listitem">
Guan, Maime, and Joachim Vandekerckhove. 2016. <span>â€œA Bayesian Approach to Mitigation of Publication Bias.â€</span> <em>Psychon. Bull. Rev.</em> 23 (1): 74â€“86. <a href="https://doi.org/10.3758/s13423-015-0868-6">https://doi.org/10.3758/s13423-015-0868-6</a>.
</div>
<div id="ref-Harrer2021-go" class="csl-entry" role="listitem">
Harrer, Mathias, Pim Cuijpers, Toshi Furukawa, and David Ebert. 2021. <em>Doing Meta-Analysis with r: A Hands-on Guide</em>. 1st ed. London, England: CRC Press.
</div>
<div id="ref-Hedges2019-ry" class="csl-entry" role="listitem">
Hedges, Larry V, and Jacob M Schauer. 2019. <span>â€œStatistical Analyses for Studying Replication: Meta-Analytic Perspectives.â€</span> <em>Psychol. Methods</em> 24 (5): 557â€“70. <a href="https://doi.org/10.1037/met0000189">https://doi.org/10.1037/met0000189</a>.
</div>
<div id="ref-Hedges2021-of" class="csl-entry" role="listitem">
â€”â€”â€”. 2021. <span>â€œThe Design of Replication Studies.â€</span> <em>J. R. Stat. Soc. Ser. A Stat. Soc.</em> 184 (3): 868â€“86. <a href="https://doi.org/10.1111/rssa.12688">https://doi.org/10.1111/rssa.12688</a>.
</div>
<div id="ref-Higgins2002-fh" class="csl-entry" role="listitem">
Higgins, Julian P T, and Simon G Thompson. 2002. <span>â€œQuantifying Heterogeneity in a Meta-Analysis.â€</span> <em>Stat. Med.</em> 21 (11): 1539â€“58. <a href="https://doi.org/10.1002/sim.1186">https://doi.org/10.1002/sim.1186</a>.
</div>
<div id="ref-Jin2015-ik" class="csl-entry" role="listitem">
Jin, Zhi-Chao, Xiao-Hua Zhou, and Jia He. 2015. <span>â€œStatistical Methods for Dealing with Publication Bias in Meta-Analysis.â€</span> <em>Stat. Med.</em> 34 (2): 343â€“60. <a href="https://doi.org/10.1002/sim.6342">https://doi.org/10.1002/sim.6342</a>.
</div>
<div id="ref-Maier2023-js" class="csl-entry" role="listitem">
Maier, Maximilian, FrantiÅ¡ek BartoÅ¡, and Eric-Jan Wagenmakers. 2023. <span>â€œRobust Bayesian Meta-Analysis: Addressing Publication Bias with Model-Averaging.â€</span> <em>Psychol. Methods</em> 28 (1): 107â€“22. <a href="https://doi.org/10.1037/met0000405">https://doi.org/10.1037/met0000405</a>.
</div>
<div id="ref-McShane2016-bk" class="csl-entry" role="listitem">
McShane, Blakeley B, Ulf BÃ¶ckenholt, and Karsten T Hansen. 2016. <span>â€œAdjusting for Publication Bias in Meta-Analysis: An Evaluation of Selection Methods and Some Cautionary Notes: An Evaluation of Selection Methods and Some Cautionary Notes.â€</span> <em>Perspect. Psychol. Sci.</em> 11 (5): 730â€“49. <a href="https://doi.org/10.1177/1745691616662243">https://doi.org/10.1177/1745691616662243</a>.
</div>
<div id="ref-Oliveira2023-yf" class="csl-entry" role="listitem">
Oliveira, ClÃ¡udia, Mara Pacheco, Janete Borges, Liliana Meira, and Anita Santos. 2023. <span>â€œInternet-Delivered Cognitive Behavioral Therapy for Anxiety Among University Students: A Systematic Review and Meta-Analysis.â€</span> <em>Internet Interv.</em> 31 (100609): 100609. <a href="https://doi.org/10.1016/j.invent.2023.100609">https://doi.org/10.1016/j.invent.2023.100609</a>.
</div>
<div id="ref-Orwin1983-vu" class="csl-entry" role="listitem">
Orwin, Robert G. 1983. <span>â€œA <span class="nocase">fail-SafeN</span> for Effect Size in Meta-Analysis.â€</span> <em>J. Educ. Stat.</em> 8 (2): 157â€“59. <a href="https://doi.org/10.3102/10769986008002157">https://doi.org/10.3102/10769986008002157</a>.
</div>
<div id="ref-Rosenberg2005-ie" class="csl-entry" role="listitem">
Rosenberg, Michael S. 2005. <span>â€œThe File-Drawer Problem Revisited: A General Weighted Method for Calculating Fail-Safe Numbers in Meta-Analysis.â€</span> <em>Evolution</em> 59 (2): 464â€“68. <a href="https://doi.org/10.1111/j.0014-3820.2005.tb01004.x">https://doi.org/10.1111/j.0014-3820.2005.tb01004.x</a>.
</div>
<div id="ref-Rosenthal1979-yx" class="csl-entry" role="listitem">
Rosenthal, Robert. 1979. <span>â€œThe File Drawer Problem and Tolerance for Null Results.â€</span> <em>Psychol. Bull.</em> 86 (3): 638â€“41. <a href="https://doi.org/10.1037/0033-2909.86.3.638">https://doi.org/10.1037/0033-2909.86.3.638</a>.
</div>
<div id="ref-Shi2019-pj" class="csl-entry" role="listitem">
Shi, Linyu, and Lifeng Lin. 2019. <span>â€œThe Trim-and-Fill Method for Publication Bias: Practical Guidelines and Recommendations Based on a Large Database of Meta-Analyses: Practical Guidelines and Recommendations Based on a Large Database of Meta-Analyses.â€</span> <em>Medicine (Baltimore)</em> 98 (23): e15987. <a href="https://doi.org/10.1097/MD.0000000000015987">https://doi.org/10.1097/MD.0000000000015987</a>.
</div>
<div id="ref-Viechtbauer2005-zt" class="csl-entry" role="listitem">
Viechtbauer, Wolfgang. 2005. <span>â€œBias and Efficiency of Meta-Analytic Variance Estimators in the Random-Effects Model.â€</span> <em>J. Educ. Behav. Stat.</em> 30 (3): 261â€“93. <a href="https://doi.org/10.3102/10769986030003261">https://doi.org/10.3102/10769986030003261</a>.
</div>
<div id="ref-Viechtbauer2010-xz" class="csl-entry" role="listitem">
â€”â€”â€”. 2010. <span>â€œConducting Meta-Analyses in <span>R</span> with the <span class="nocase">metafor</span> Package.â€</span> <em>Journal of Statistical Software</em>. <a href="https://doi.org/10.18637/jss.v036.i03">https://doi.org/10.18637/jss.v036.i03</a>.
</div>
<div id="ref-Viechtbauer2021-od" class="csl-entry" role="listitem">
â€”â€”â€”. 2021. <span>â€œSelection Models for Publication Bias in Meta-Analysis. Presentation at <span>ESMARConf2021</span>.â€</span> figshare. <a href="https://doi.org/10.6084/M9.FIGSHARE.13637900.V1">https://doi.org/10.6084/M9.FIGSHARE.13637900.V1</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>If you are interested in meta-analysis simulation we wrote a preprint <a href="https://psyarxiv.com/br6vy/">https://psyarxiv.com/br6vy/</a><a href="#fnref1" class="footnote-back" role="doc-backlink">â†©ï¸Ž</a></p></li>
<li id="fn2"><p>see https://www.jepusto.com/simulating-correlated-smds/ for a nice blog post about simulations<a href="#fnref2" class="footnote-back" role="doc-backlink">â†©ï¸Ž</a></p></li>
<li id="fn3"><p>See <span class="citation" data-cites="Harrer2021-go">Harrer et al. (<a href="#ref-Harrer2021-go" role="doc-biblioref">2021</a>)</span> (Chapter 5) and <span class="citation" data-cites="Hedges2019-ry">Hedges and Schauer (<a href="#ref-Hedges2019-ry" role="doc-biblioref">2019</a>)</span> for an overview about the Q statistics<a href="#fnref3" class="footnote-back" role="doc-backlink">â†©ï¸Ž</a></p></li>
<li id="fn4"><p>see <a href="https://www.meta-analysis-workshops.com/download/common-mistakes1.pdf">https://www.meta-analysis-workshops.com/download/common-mistakes1.pdf</a><a href="#fnref4" class="footnote-back" role="doc-backlink">â†©ï¸Ž</a></p></li>
<li id="fn5"><p>Thanks to the Wolfgang Viechtbauerâ€™s course <a href="https://www.wvbauer.com/doku.php/course_ma">https://www.wvbauer.com/doku.php/course_ma</a><a href="#fnref5" class="footnote-back" role="doc-backlink">â†©ï¸Ž</a></p></li>
<li id="fn6"><p><a href="https://www.youtube.com/watch?v=ucmOCuyCk-c">https://www.youtube.com/watch?v=ucmOCuyCk-c</a><a href="#fnref6" class="footnote-back" role="doc-backlink">â†©ï¸Ž</a></p></li>
</ol>
</section></div></main> <!-- /main -->

<script>
  // htmlwidgets need to know to resize themselves when slides are shown/hidden.
  // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
  // slide changes (different for each slide format).
  (function () {
    // dispatch for htmlwidgets
    function fireSlideEnter() {
      const event = window.document.createEvent("Event");
      event.initEvent("slideenter", true, true);
      window.document.dispatchEvent(event);
    }

    function fireSlideChanged(previousSlide, currentSlide) {
      fireSlideEnter();

      // dispatch for shiny
      if (window.jQuery) {
        if (previousSlide) {
          window.jQuery(previousSlide).trigger("hidden");
        }
        if (currentSlide) {
          window.jQuery(currentSlide).trigger("shown");
        }
      }
    }

    // hookup for slidy
    if (window.w3c_slidy) {
      window.w3c_slidy.add_observer(function (slide_num) {
        // slide_num starts at position 1
        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
      });
    }

  })();
</script>

<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>